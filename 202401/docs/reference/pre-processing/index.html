<!DOCTYPE html><html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-reference/pre-processing"><head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Pre-processing | 導入実績5000社以上の国産エンタープライズ・ヘッドレスCMS</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:url" content="https://kuroco.app/docs/reference/pre-processing/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:type" content="website"><meta data-rh="true" property="og:image" content="https://kuroco.app/kuroco-card.png"><meta data-rh="true" name="twitter:card" content="summary"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Pre-processing | 導入実績5000社以上の国産エンタープライズ・ヘッドレスCMS"><meta data-rh="true" name="description" content="Pre-processing is a user-defined custom function that is called before executing the main process of API endpoints."><meta data-rh="true" property="og:description" content="Pre-processing is a user-defined custom function that is called before executing the main process of API endpoints."><link data-rh="true" rel="icon" href="/img/icon_kurocoDocument.svg"><link data-rh="true" rel="canonical" href="https://kuroco.app/docs/reference/pre-processing/"><link data-rh="true" rel="alternate" href="https://kuroco.app/docs/reference/pre-processing/" hreflang="en"><link data-rh="true" rel="alternate" href="https://kuroco.app/ja/docs/reference/pre-processing/" hreflang="ja"><link data-rh="true" rel="alternate" href="https://kuroco.app/docs/reference/pre-processing/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="導入実績5000社以上の国産エンタープライズ・ヘッドレスCMS RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="導入実績5000社以上の国産エンタープライズ・ヘッドレスCMS Atom Feed">

<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-PBPV4WW",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script><link rel="stylesheet" href="/assets/css/styles.b0cacabf.css">
<link rel="preload" href="/assets/js/runtime~main.da1a0a86.js" as="script">
<link rel="preload" href="/assets/js/main.8624ea78.js" as="script">
<script type="application/ld+json">{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "WebPage",
      "isPartOf": {
        "@id": "https://kuroco.app/#website"
      },
      "@id": "https://kuroco.app/docs/reference/pre-processing//#webpage",
      "url": "https://kuroco.app/docs/reference/pre-processing/",
      "name": "Pre-processing",
      "description": "Pre-processing is a user-defined custom function that is called before executing the main process of API endpoints.",
      "inLanguage": "en",
      "datePublished": "2024-01-18T06:16:57.952Z",
      "dateModified": "2024-01-18T06:16:57.952Z",
      "breadcrumb": {
        "@id": "https://kuroco.app/docs/reference/pre-processing//#breadcrumb"
      },
      "potentialAction": [
        {
          "@type": "ReadAction",
          "target": [
            "https://kuroco.app/docs/reference/pre-processing/"
          ]
        }
      ]
    },
    {
      "@type": "BreadcrumbList",
      "@id": "https://kuroco.app/docs/reference/pre-processing//#breadcrumb",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "item": "https://kuroco.app/",
          "name": "Home"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "item": "https://kuroco.app/docs",
          "name": "Documentation"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "reference - pre-processing - Pre-processing"
        }
      ]
    },
    {
      "@type": "WebSite",
      "@id": "https://kuroco.app/#website",
      "name": "導入実績5000社以上の国産エンタープライズ・ヘッドレスCMS",
      "url": "https://kuroco.app/",
      "description": "Kuroco is enterprise Headless CMS for API-first development.",
      "publisher": {
        "@id": "https://kuroco.app/#organization"
      }
    },
    {
      "@type": "Organization",
      "@id": "https://kuroco.app/#organization",
      "name": "導入実績5000社以上の国産エンタープライズ・ヘッドレスCMS",
      "url": "https://kuroco.app/",
      "sameAs": [
        "https://www.diverta.co.jp/"
      ],
      "contactPoint": {
        "@type": "ContactPoint",
        "url": "https://www.diverta.co.jp/en/contact/"
      },
      "logo": {
        "@type": "ImageObject",
        "@id": "https://www.diverta.co.jp/#logo",
        "url": "https://kuroco.app/files/user/img/common/logo_Kuroco_black.svg",
        "contentUrl": "https://kuroco.app/files/user/img/common/logo_Kuroco_black.svg",
        "width": 155,
        "height": 56,
        "caption": "Diverta Inc."
      },
      "address": {
        "@type": "PostalAddress",
        "addressCountry": "JP",
        "postalCode": "162-0823",
        "streetAddress": "Central Plaza 6F 1-1 Kaguragashi Shinjuku-ku, Tokyo, Japan"
      }
    }
  ]
}</script></head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PBPV4WW" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div class="z-[600] fixed h-screen w-full flex items-center justify-center invisible"><div><svg class="animate-spin h-40 w-40 text-gray-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-50" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="fill-primary" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></div></div><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://kuroco.app/" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/logo.svg" alt="Kuroco home" class="themedImage_ToTc themedImage--light_HNdA" height="37.5px"><img src="/img/logo_dark.svg" alt="Kuroco home" class="themedImage_ToTc themedImage--dark_i4oU" height="37.5px"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Home</a><a class="navbar__item navbar__link" href="/quick-guide/">Quick guide</a><a class="navbar__item navbar__link" href="/docs/about/about-kuroco/">About Kuroco</a><a class="navbar__item navbar__link" href="/docs/management/dashboard/">Admin Manual</a><a class="navbar__item navbar__link" href="/docs/about/support/">Support</a><a class="navbar__item navbar__link" href="/docs/faq/">FAQ</a><a class="navbar__item navbar__link" href="/docs/update/kuroco-roadmap/">Releases</a><a class="navbar__item navbar__link" href="/docs/about/sales/">Materials</a></div><div class="navbar__items navbar__items--right"><button type="button" class="button button--outline button--secondary py-3 px-3 border-0"><svg aria-hidden="true" class="w-5 h-5 align-middle" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg><span class="sr-only">Search</span></button><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/reference/pre-processing/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/ja/docs/reference/pre-processing/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><div class="light"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/tutorials/beginners-guide/">Tutorial</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/reference/endpoint-settings/">Reference</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/reference/endpoint-settings/">API</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/endpoint-settings/">Endpoint settings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/error/">API Error Response</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/reference/pre-processing/">Pre-processing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/post-processing/">Post-processing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/filter-query/">Using the filter query function</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/r-filter/">Filter function based on related data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/order-by-location/">Sorting by Location Information</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/api-cache/">API cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/reference/cache-clear-operation/">Timing and scope of API cache clearing</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/reference/list-of-extra-column-available-on-content/">Content management</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/reference/form-field-list/">Form management</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/reference/api-convert-image/">File</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/reference/list-of-extra-column-available-on-member-field-settings/">Member management</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/reference/batch-list/">Operation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/reference/mail-variables/">Variables</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/reference/external-api-integration-guide/">External API</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/reference/sync-site-data/">Environment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/reference/smarty-plugin/">Smarty</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/management/dashboard/">Admin panel user guide</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><span class="breadcrumbs__link">Reference</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">API</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Pre-processing</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Pre-processing</h1></header><p>Pre-processing is a user-defined custom function that is called before executing the main process of API endpoints.
You can set pre-processing to the configured endpoints.</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>The processing logic implemented in the pre-processing is not reflected in the API information (Swagger UI) page or the <code>openapi.json</code> file, so there may be differences between the information displayed on the screen and the actual specifications. For this reason, it is recommended that the specifications of the customised parts are described in the endpoint description instead.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="steps-to-set-up-pre-processing-in-endpoints">Steps to set up pre-processing in endpoints<a href="#steps-to-set-up-pre-processing-in-endpoints" class="hash-link" aria-label="Direct link to Steps to set up pre-processing in endpoints" title="Direct link to Steps to set up pre-processing in endpoints">​</a></h2><p>Pre-processing can be set up in the following steps.</p><ol><li>Write the pre-processing logic in the custom function</li><li>Add the custom function in the pre-processing settings of the endpoint</li></ol><p>The detailed information of the above steps are as follows:</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="write-the-program-in-the-custom-function">Write the program in the custom function<a href="#write-the-program-in-the-custom-function" class="hash-link" aria-label="Direct link to Write the program in the custom function" title="Direct link to Write the program in the custom function">​</a></h3><p>Access the <a href="/docs/management/function/">custom function editor page</a> and create a custom function for the pre-processing logic.</p><p><img loading="lazy" src="https://t.gyazo.com/teams/diverta/bd5aa3aa781410f063d6234959bfb470.png?width=600" data-zoom-src="https://t.gyazo.com/teams/diverta/bd5aa3aa781410f063d6234959bfb470.png" alt="Image from Gyazo" class="img_ev3q">
To avoid confusion with custom functions created for other purposes, it is recommended to set it up according to the following rules.</p><ul><li>Create a category to group the pre-processing custom functions together</li><li>Set the title of the custom function to be the same as the path name of the endpoint, so that it is easier to identify and associate them together.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="associate-the-custom-function-with-the-endpoint-settings">Associate the custom function with the endpoint settings<a href="#associate-the-custom-function-with-the-endpoint-settings" class="hash-link" aria-label="Direct link to Associate the custom function with the endpoint settings" title="Direct link to Associate the custom function with the endpoint settings">​</a></h3><p><strong>1. Access API list page</strong>  </p><p>Select the API on the side menu and access <a href="/docs/management/api-list/">API list page</a>.</p><p><img loading="lazy" src="https://t.gyazo.com/teams/diverta/1ddfd9a36428813fc26b3caba00fe493.png?width=600" data-zoom-src="https://t.gyazo.com/teams/diverta/1ddfd9a36428813fc26b3caba00fe493.png" alt="Image (fetched from Gyazo)" class="img_ev3q">  </p><p><strong>2. Select the endpoint</strong>  </p><p>Select the endpoint you want to implement and click the <!-- -->[Pre-processing]<!-- --> button.</p><p><img loading="lazy" src="https://t.gyazo.com/teams/diverta/233d54b03f8aeccb2501973ec30623f7.png?width=600" data-zoom-src="https://t.gyazo.com/teams/diverta/233d54b03f8aeccb2501973ec30623f7.png" alt="Image (fetched from Gyazo)" class="img_ev3q">  </p><p><strong>3. Add a pre-process and select the custom function</strong>  </p><p>Select the category that the custom function is grouped under then select the custom function by its title under the <code>Contents</code> field to associate the custom function to the pre-processing of the endpoint.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>The endpoint may not work as expected if the incorrect custom function is selected in the endpoint's pre-processing settings.</p></div></div><p><img loading="lazy" src="https://t.gyazo.com/teams/diverta/50faf2265340ee1bbe6e960605bdb240.png?width=600" data-zoom-src="https://t.gyazo.com/teams/diverta/50faf2265340ee1bbe6e960605bdb240.png" alt="Image (fetched from Gyazo)" class="img_ev3q">  </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="variables-of-pre-processing">Variables of pre-processing<a href="#variables-of-pre-processing" class="hash-link" aria-label="Direct link to Variables of pre-processing" title="Direct link to Variables of pre-processing">​</a></h2><p>Variables used in pre-processing have reserved words with specific meanings. These variables may be used to customize the behaviour of the endpoint.</p><table><thead><tr><th align="left">Variable</th><th align="left">Usage</th></tr></thead><tbody><tr><td align="left">$meta</td><td align="left">Data reference (read only)</td></tr><tr><td align="left">$url</td><td align="left">Data reference (read only)</td></tr><tr><td align="left">$body</td><td align="left">Data reference (read only)</td></tr><tr><td align="left">$errors</td><td align="left">Custom error handling (write action)</td></tr><tr><td align="left">$request</td><td align="left">Modify API request body (write action)</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="variables-for-reference">Variables for reference<a href="#variables-for-reference" class="hash-link" aria-label="Direct link to Variables for reference" title="Direct link to Variables for reference">​</a></h2><p>The following variables are reference variables that are always assigned by default when pre-processing is executed.<br>
<!-- -->They are used to determine the endpoint information and the request value passed.</p><table><thead><tr><th align="left">Variable name</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><a href="#meta">$meta</a></td><td align="left">Meta data of the endpoint</td></tr><tr><td align="left"><a href="#url">$url</a></td><td align="left">URL component</td></tr><tr><td align="left"><a href="#body">$body</a></td><td align="left">Request body</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="meta">$meta<a href="#meta" class="hash-link" aria-label="Direct link to $meta" title="Direct link to $meta">​</a></h3><p>This variable contains the meta data of the associated endpoint.</p><table><thead><tr><th align="left">Variable</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">$meta</td><td align="left">object</td><td align="left">All meta data of the endpoint</td></tr></tbody></table><p>This variable contains the following data.  </p><table><thead><tr><th align="left">Key</th><th align="left">Type</th><th align="left">Initial value</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">$meta.content_type</td><td align="left">string</td><td align="left"></td><td align="left">Content-type</td></tr><tr><td align="left">$meta.mime</td><td align="left">object</td><td align="left"></td><td align="left">MIME type and MIME sub-type</td></tr><tr><td align="left">$meta.mime.type</td><td align="left">string</td><td align="left"></td><td align="left">MIME type</td></tr><tr><td align="left">$meta.mime.subtype</td><td align="left">string</td><td align="left"></td><td align="left">MIME sub-type</td></tr><tr><td align="left">$meta.output_format</td><td align="left">string</td><td align="left">"json"</td><td align="left"><code>_output_format</code> specified in query parameter</td></tr><tr><td align="left">$meta.lang</td><td align="left">string</td><td align="left">Determined based on the following priorities: <br>[Browser language &gt; Main language settings]</td><td align="left"><code>_lang</code> specified in query parameter</td></tr><tr><td align="left">$meta.charset</td><td align="left">string</td><td align="left">"utf8"</td><td align="left"><code>_charset</code> specified in query parameter</td></tr><tr><td align="left">$meta.http_code</td><td align="left">string</td><td align="left">null</td><td align="left"></td></tr><tr><td align="left">$meta.api_header</td><td align="left">object</td><td align="left"></td><td align="left">API settings</td></tr><tr><td align="left">$meta.post_json</td><td align="left">string</td><td align="left">GET: null <br> POST: "{}"</td><td align="left">JSON body in text format</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="url">$url<a href="#url" class="hash-link" aria-label="Direct link to $url" title="Direct link to $url">​</a></h3><p>This variable contains the component of the URL specified by the client.</p><table><thead><tr><th align="left">Variable name</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">$url</td><td align="left">object</td><td align="left">Endpoint path and query parameter data</td></tr></tbody></table><p>This variable contains the following data.<br>
<!-- -->Among the following, <code>$url.query</code> contains the same value as <code>$smarty.get</code>.</p><table><thead><tr><th align="left">Key</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">$url.path</td><td align="left">string</td><td align="left">Path of the endpoint</td></tr><tr><td align="left">$url.query</td><td align="left">object</td><td align="left">Query parameter</td></tr></tbody></table><p>For example, for requests sent to the following endpoint:
<code>https://your-api-domain/rcms-api/1/endpoint_name?p1=VALUE1&amp;p2[]=VALUE2_0&amp;p2[]=VALUE2_1&amp;p3[k1]=VALUE3_1&amp;p3[k2]=VALUE3_2</code>  </p><p>The following value will be set in <code>$url</code>:</p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">$url</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"path"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"/rcms-api/1/endpoint_name"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"query"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"p1"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"VALUE1"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"p2"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">"VALUE2_0"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">"VALUE2_1"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">"p3"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">"k1"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"VALUE3_1"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token property" style="color:#36acaa">"k2"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"VALUE3_2"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><br><h3 class="anchor anchorWithStickyNavbar_LWe7" id="body">$body<a href="#body" class="hash-link" aria-label="Direct link to $body" title="Direct link to $body">​</a></h3><p>This variable references the components of the URL specified by the client.<br>
<!-- -->It contains the same value as <code>$smarty.post</code>.  </p><table><thead><tr><th align="left">Variable name</th><th align="left">Type</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">$body</td><td align="left">object</td><td align="left">Endpoint's request body</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="variables-for-api-control">Variables for API control<a href="#variables-for-api-control" class="hash-link" aria-label="Direct link to Variables for API control" title="Direct link to Variables for API control">​</a></h2><p>The following variables are not declared at the time the pre-process runs.<br>
<!-- -->Initialising them and populating them with values allows you to control the behavior of the endpoint.  </p><table><thead><tr><th align="left">Variable name</th><th align="left">Usage</th></tr></thead><tbody><tr><td align="left"><a href="#errors">$errors</a></td><td align="left">Custom error handling</td></tr><tr><td align="left"><a href="#request">$request</a></td><td align="left">Modify API endpoint's request body</td></tr></tbody></table><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>Do not declare these variables for any purpose other than their intended one within the pre-processing custom function, as this may lead to to unintended behavior of the API endpoints.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="errors">$errors<a href="#errors" class="hash-link" aria-label="Direct link to $errors" title="Direct link to $errors">​</a></h3><p>This variable can be used to perform custom error handling in the endpoint.  </p><p>You can implement your own validation process on the endpoint by determining the input value and storing the resulting error message in an array.  </p><table><thead><tr><th align="left">Variable name</th><th align="left">Type</th><th align="left">Initial value</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">$errors</td><td align="left">object</td><td align="left">null</td><td align="left">API endpoint's error codes and messages</td></tr></tbody></table><p><strong>Code example</strong></p><div class="language-smarty codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-smarty codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token smarty language-smarty comment" style="color:#999988;font-style:italic">{* Initialize it as an empty array. *}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token smarty language-smarty delimiter punctuation" style="color:#393A34">{</span><span class="token smarty language-smarty keyword" style="color:#00009f">assign_array</span><span class="token smarty language-smarty"> </span><span class="token smarty language-smarty attr-name" style="color:#00a4db">var</span><span class="token smarty language-smarty operator" style="color:#393A34">=</span><span class="token smarty language-smarty string" style="color:#e3116c">'errors'</span><span class="token smarty language-smarty"> </span><span class="token smarty language-smarty attr-name" style="color:#00a4db">values</span><span class="token smarty language-smarty operator" style="color:#393A34">=</span><span class="token smarty language-smarty string" style="color:#e3116c">''</span><span class="token smarty language-smarty delimiter punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token smarty language-smarty comment" style="color:#999988;font-style:italic">{* Validate input value. *}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token smarty language-smarty delimiter punctuation" style="color:#393A34">{</span><span class="token smarty language-smarty keyword" style="color:#00009f">if</span><span class="token smarty language-smarty"> </span><span class="token smarty language-smarty variable" style="color:#36acaa">$smarty</span><span class="token smarty language-smarty punctuation" style="color:#393A34">.</span><span class="token smarty language-smarty variable" style="color:#36acaa">post</span><span class="token smarty language-smarty punctuation" style="color:#393A34">.</span><span class="token smarty language-smarty variable" style="color:#36acaa">key_name</span><span class="token smarty language-smarty"> </span><span class="token smarty language-smarty operator" style="color:#393A34">===</span><span class="token smarty language-smarty"> </span><span class="token smarty language-smarty string" style="color:#e3116c">'VALUE'</span><span class="token smarty language-smarty delimiter punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token smarty language-smarty comment" style="color:#999988;font-style:italic">{* Add error message in the array. *}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token smarty language-smarty delimiter punctuation" style="color:#393A34">{</span><span class="token smarty language-smarty keyword" style="color:#00009f">assign</span><span class="token smarty language-smarty"> </span><span class="token smarty language-smarty attr-name" style="color:#00a4db">var</span><span class="token smarty language-smarty operator" style="color:#393A34">=</span><span class="token smarty language-smarty string" style="color:#e3116c">'errors.'</span><span class="token smarty language-smarty"> </span><span class="token smarty language-smarty attr-name" style="color:#00a4db">value</span><span class="token smarty language-smarty operator" style="color:#393A34">=</span><span class="token smarty language-smarty string" style="color:#e3116c">'An error has occurred.'</span><span class="token smarty language-smarty delimiter punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token smarty language-smarty delimiter punctuation" style="color:#393A34">{/</span><span class="token smarty language-smarty keyword" style="color:#00009f">if</span><span class="token smarty language-smarty delimiter punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><br><p><strong>Error response format</strong>  </p><table><thead><tr><th align="left">HTTP status code</th><th align="left">errors[].code</th><th align="left">errors[].message</th></tr></thead><tbody><tr><td align="left">422</td><td align="left">unprocessable_entity</td><td align="left">Messages stored in <code>errors</code> object</td></tr></tbody></table><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">ExampleResponse</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Response example</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"errors"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"code"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"unprocessable_entity"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">"message"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"An error has occurred."</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">"x-rcms-request-id"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"xxxxxxxx-xxxx-xxxx-xxxx-xxxx"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><br><p>If <code>$errors</code> object contains more than 1 element, the response format is as follows:  </p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">errors</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">"code"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"unprocessable_entity"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">"message"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"messages stored in errors object"</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><br><p>If the <code>$errors</code> array contains multiple element, an object is outputted for each of the errors.  </p><div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">errors</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">"code"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"unprocessable_entity"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">"message"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"error message 1"</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">"code"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"unprocessable_entity"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token property" style="color:#36acaa">"message"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"error message 2"</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><br><h3 class="anchor anchorWithStickyNavbar_LWe7" id="request">$request<a href="#request" class="hash-link" aria-label="Direct link to $request" title="Direct link to $request">​</a></h3><p>This variable can be used to modify the request values passed to the pre-process custom function.</p><table><thead><tr><th align="left">Variable name</th><th align="left">Type</th><th align="left">Initial value</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left">$request</td><td align="left">object</td><td align="left">null</td><td align="left">Custom request body for the pre-processing</td></tr></tbody></table><p>By setting a value in this variable in the following format, you can add or overwrite the request value (GET / POST) to be passed to the pre-process custom function.</p><div class="language-smarty codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-smarty codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token smarty language-smarty delimiter punctuation" style="color:#393A34">{</span><span class="token smarty language-smarty keyword" style="color:#00009f">assign</span><span class="token smarty language-smarty"> </span><span class="token smarty language-smarty attr-name" style="color:#00a4db">var</span><span class="token smarty language-smarty operator" style="color:#393A34">=</span><span class="token smarty language-smarty string" style="color:#e3116c">'request.***(target key name)'</span><span class="token smarty language-smarty"> </span><span class="token smarty language-smarty attr-name" style="color:#00a4db">value</span><span class="token smarty language-smarty operator" style="color:#393A34">=</span><span class="token smarty language-smarty string" style="color:#e3116c">'***(value)'</span><span class="token smarty language-smarty delimiter punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><br><p>To set the value based on the existing request value from the API endpoint, use the following reference variable.</p><table><thead><tr><th align="left">Variable name</th><th align="left">Remark</th></tr></thead><tbody><tr><td align="left">$url.query</td><td align="left">Alternative variable name: <code>$smarty.get</code></td></tr><tr><td align="left">$body</td><td align="left">Alternative variable name: <code>$smarty.post</code></td></tr></tbody></table><p><strong>Code sample</strong></p><div class="language-smarty codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-smarty codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token smarty language-smarty comment" style="color:#999988;font-style:italic">{* Initialize as empty array *}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token smarty language-smarty delimiter punctuation" style="color:#393A34">{</span><span class="token smarty language-smarty keyword" style="color:#00009f">assign_array</span><span class="token smarty language-smarty"> </span><span class="token smarty language-smarty attr-name" style="color:#00a4db">var</span><span class="token smarty language-smarty operator" style="color:#393A34">=</span><span class="token smarty language-smarty string" style="color:#e3116c">'request'</span><span class="token smarty language-smarty"> </span><span class="token smarty language-smarty attr-name" style="color:#00a4db">values</span><span class="token smarty language-smarty operator" style="color:#393A34">=</span><span class="token smarty language-smarty string" style="color:#e3116c">''</span><span class="token smarty language-smarty delimiter punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token smarty language-smarty comment" style="color:#999988;font-style:italic">{* Determine if there is a request value *}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token smarty language-smarty delimiter punctuation" style="color:#393A34">{</span><span class="token smarty language-smarty keyword" style="color:#00009f">if</span><span class="token smarty language-smarty"> </span><span class="token smarty language-smarty variable" style="color:#36acaa">$url</span><span class="token smarty language-smarty punctuation" style="color:#393A34">.</span><span class="token smarty language-smarty variable" style="color:#36acaa">query</span><span class="token smarty language-smarty punctuation" style="color:#393A34">.</span><span class="token smarty language-smarty variable" style="color:#36acaa">filter</span><span class="token smarty language-smarty delimiter punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token smarty language-smarty comment" style="color:#999988;font-style:italic">{* overwrite query parameter *}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token smarty language-smarty delimiter punctuation" style="color:#393A34">{</span><span class="token smarty language-smarty keyword" style="color:#00009f">assign</span><span class="token smarty language-smarty"></span><br></span><span class="token-line" style="color:#393A34"><span class="token smarty language-smarty">    </span><span class="token smarty language-smarty attr-name" style="color:#00a4db">var</span><span class="token smarty language-smarty operator" style="color:#393A34">=</span><span class="token smarty language-smarty string" style="color:#e3116c">'request.filter'</span><span class="token smarty language-smarty"></span><br></span><span class="token-line" style="color:#393A34"><span class="token smarty language-smarty">    </span><span class="token smarty language-smarty attr-name" style="color:#00a4db">value</span><span class="token smarty language-smarty operator" style="color:#393A34">=</span><span class="token smarty language-smarty string" style="color:#e3116c">"`</span><span class="token smarty language-smarty string variable" style="color:#36acaa">$url</span><span class="token smarty language-smarty string" style="color:#e3116c">.query.filter AND topics_id in [1, 2, 3]"</span><span class="token smarty language-smarty delimiter punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token smarty language-smarty delimiter punctuation" style="color:#393A34">{/</span><span class="token smarty language-smarty keyword" style="color:#00009f">if</span><span class="token smarty language-smarty delimiter punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><br><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reference-tutorial">Reference tutorial<a href="#reference-tutorial" class="hash-link" aria-label="Direct link to Reference tutorial" title="Direct link to Reference tutorial">​</a></h2><p>Here is the tutorial on how to implement a pre-processing:</p><ul><li><a href="/docs/tutorials/how-to-implement-original-validation-in-api-by-using-function/">How to implement original validation in API by using custom functionn</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2><p>If the pre-processing is not working as expected, check the following points:</p><ul><li>Check if the API pre-processing is associated with the custom function properly.</li><li>Check if the associated custom function is correct.</li><li>Check if the variable names are correct.</li><li>Check if the data format stored in the variables are correct.</li><li>Check if the custom function syntax is correct.</li></ul></div><div class="mt-10 pt-5"><hr class="border-t border-solid border-gray-300 dark:border-gray-900"><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/diverta/kuroco-documents/tree/main/packages/create-docusaurus/templates/shared/docs/reference/pre-processing.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer><div class="card rounded-lg container mt-10 p-8 border-none bg-primary-soft dark:bg-slate-800 mb-10"><h2 class="text-2xl">Support</h2><p class="text-gray-800 dark:text-white">If you have any other questions, please contact us or check out Our Slack Community.</p><div class="md:flex mt-0"><div class="md:inline-flex rounded-md shadow"><a href="https://kuroco.zendesk.com/hc/" target="_blank" rel="noreferrer" class="button button--primary px-5 py-3 block">Contact form</a></div><div class="mt-3 md:mt-0 md:ml-4 md:inline-flex rounded-md shadow"><a href="/docs/about/support/" target="_blank" rel="noreferrer" class="button button--primary px-5 py-3 block">Join Kuroco Slack community</a></div></div></div></div></article></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#steps-to-set-up-pre-processing-in-endpoints" class="table-of-contents__link toc-highlight">Steps to set up pre-processing in endpoints</a><ul><li><a href="#write-the-program-in-the-custom-function" class="table-of-contents__link toc-highlight">Write the program in the custom function</a></li><li><a href="#associate-the-custom-function-with-the-endpoint-settings" class="table-of-contents__link toc-highlight">Associate the custom function with the endpoint settings</a></li></ul></li><li><a href="#variables-of-pre-processing" class="table-of-contents__link toc-highlight">Variables of pre-processing</a></li><li><a href="#variables-for-reference" class="table-of-contents__link toc-highlight">Variables for reference</a><ul><li><a href="#meta" class="table-of-contents__link toc-highlight">$meta</a></li><li><a href="#url" class="table-of-contents__link toc-highlight">$url</a></li><li><a href="#body" class="table-of-contents__link toc-highlight">$body</a></li></ul></li><li><a href="#variables-for-api-control" class="table-of-contents__link toc-highlight">Variables for API control</a><ul><li><a href="#errors" class="table-of-contents__link toc-highlight">$errors</a></li><li><a href="#request" class="table-of-contents__link toc-highlight">$request</a></li></ul></li><li><a href="#reference-tutorial" class="table-of-contents__link toc-highlight">Reference tutorial</a></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a></li></ul></div></div></div></div></main></div></div><div style="position:fixed;z-index:9999;top:16px;left:16px;right:16px;bottom:16px;pointer-events:none"></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">SITEMAP</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/quick-guide/">Quick Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/about/about-kuroco/">About Kuroco</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/about/what-is-a-headless-cms/">What is a Headless CMS?</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/management/dashboard/">Admin Manual</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/about/support/">Support</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/faq/">FAQ</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/update/kuroco-roadmap/">Releases</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/about/sales/">Materials</a></li><li class="footer__item"><a href="https://kuroco.statuspal.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Status<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">COMPANY</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://kuroco.zendesk.com/hc/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact us<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://kuroco.app/files/legal/Kuroco-terms-of-service.pdf" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms &amp; conditions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.diverta.co.jp/en/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Diverta Inc. All rights reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.da1a0a86.js"></script>
<script src="/assets/js/main.8624ea78.js"></script>

</body></html>