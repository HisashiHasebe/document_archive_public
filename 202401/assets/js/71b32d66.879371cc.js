"use strict";(self.webpackChunkkurokuro=self.webpackChunkkurokuro||[]).push([[5916],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),d=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=d(e.components);return r.createElement(l.Provider,{value:t},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),m=d(n),u=a,h=m["".concat(l,".").concat(u)]||m[u]||c[u]||o;return n?r.createElement(h,s(s({ref:t},p),{},{components:n})):r.createElement(h,s({ref:t},p))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,s=new Array(o);s[0]=u;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[m]="string"==typeof e?e:a,s[1]=i;for(var d=2;d<o;d++)s[d]=n[d];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},13433:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(67294);function a(e){let{faqs:t=[]}=e;if(0===(Array.isArray(t)?t.filter((e=>e.question&&e.answer)):[]).length)return null;const n={"@context":"https://schema.org","@type":"FAQPage",mainEntity:t.map((e=>({"@type":"Question",name:e.question,acceptedAnswer:{"@type":"Answer",text:e.answer}})))},a=JSON.stringify(n,null,2);return r.createElement("script",{type:"application/ld+json"},a)}},58292:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>l,toc:()=>p});var r=n(87462),a=(n(67294),n(3905)),o=n(13433);const s={title:"Can I limit form responses to one per user?",description:"Create an endpoint to check whether the target user has already submitted a response, and switch the frontend display based on the response accordingly.",category:"howto"},i=void 0,l={unversionedId:"faq/how-to-limit-form-responses-to-once-per-user",id:"faq/how-to-limit-form-responses-to-once-per-user",title:"Can I limit form responses to one per user?",description:"Create an endpoint to check whether the target user has already submitted a response, and switch the frontend display based on the response accordingly.",source:"@site/docs/faq/how-to-limit-form-responses-to-once-per-user.mdx",sourceDirName:"faq",slug:"/faq/how-to-limit-form-responses-to-once-per-user",permalink:"/docs/faq/how-to-limit-form-responses-to-once-per-user",draft:!1,editUrl:"https://github.com/diverta/kuroco-documents/tree/main/packages/create-docusaurus/templates/shared/docs/faq/how-to-limit-form-responses-to-once-per-user.mdx",tags:[],version:"current",frontMatter:{title:"Can I limit form responses to one per user?",description:"Create an endpoint to check whether the target user has already submitted a response, and switch the frontend display based on the response accordingly.",category:"howto"},sidebar:"faqSidebar",previous:{title:"How can I get the number of associated contents for each option?",permalink:"/docs/faq/how-to-get-the-number-of-contents-linked-to-each-option"},next:{title:"Where is the best place to store static files (images, JS, CSS, etc.) used on the site?",permalink:"/docs/faq/how-to-place-static-files"}},d={},p=[{value:"Example settings",id:"example-settings",level:2},{value:"Endpoint",id:"endpoint",level:3},{value:"Example of frontend code",id:"example-of-frontend-code",level:3},{value:"Hide form items when the user has already submitted a response",id:"hide-form-items-when-the-user-has-already-submitted-a-response",level:4},{value:"Disable submit button when the form has been answered",id:"disable-submit-button-when-the-form-has-been-answered",level:4},{value:"Return an error when the form is already answered during form submission",id:"return-an-error-when-the-form-is-already-answered-during-form-submission",level:4},{value:"Related documentation",id:"related-documentation",level:2}],m={toc:p},c="wrapper";function u(e){let{components:t,...n}=e;return(0,a.kt)(c,(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)(o.Z,{faqs:[{question:"Can I limit form responses to one per user?",answer:"Create an endpoint to check whether the target user has already submitted a response, and switch the frontend display based on the response accordingly."}],mdxType:"StructuredDataFaqs"}),(0,a.kt)("p",null,"Create an endpoint to check whether the target user has already submitted a response, and switch the frontend display based on the response accordingly."),(0,a.kt)("h2",{id:"example-settings"},"Example settings"),(0,a.kt)("h3",{id:"endpoint"},"Endpoint"),(0,a.kt)("p",null,"Create the following endpoint in the Kuroco management screen. If there is no response, the response of ",(0,a.kt)("inlineCode",{parentName:"p"},"pageInfo.totalCnt")," will be 0."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:"left"},"Item"),(0,a.kt)("th",{parentName:"tr",align:"left"},"Setting"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Path"),(0,a.kt)("td",{parentName:"tr",align:"left"},"check_answer")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Category"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Form")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Model"),(0,a.kt)("td",{parentName:"tr",align:"left"},"InquiryMessage")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"Operation"),(0,a.kt)("td",{parentName:"tr",align:"left"},"List")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"inquiry_id"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Target form ID")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"self_only"),(0,a.kt)("td",{parentName:"tr",align:"left"},"Check the box")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"left"},"cnt"),(0,a.kt)("td",{parentName:"tr",align:"left"},"1")))),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/16d804d6d914d9a75a52a8c4de33fe62.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/16d804d6d914d9a75a52a8c4de33fe62.png",alt:"Image from Gyazo"}),(0,a.kt)("br",{parentName:"p"}),"\n",(0,a.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/65a034a08052627da0b699e2a57b13dc.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/65a034a08052627da0b699e2a57b13dc.png",alt:"Image from Gyazo"})),(0,a.kt)("h3",{id:"example-of-frontend-code"},"Example of frontend code"),(0,a.kt)("h4",{id:"hide-form-items-when-the-user-has-already-submitted-a-response"},"Hide form items when the user has already submitted a response"),(0,a.kt)("p",null,"For example, if you write the following code, the form items will not be displayed if the user has already submitted a response."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-markup"},"<template>\n  <div>\n    <div v-if=\"hadSubmitted.pageInfo.totalCnt == 0\">\n      <form>\n        \u30fb\u30fb\u30fb\n        Display form items here\n        \u30fb\u30fb\u30fb\n      </form>\n    </div>\n    <div v-else>\n      The response has already been submitted.\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  async asyncData({ $axios }) {\n    return {\n      response: await $axios.$get('/rcms-api/1/inquiry/1'),\n      hadSubmitted: await $axios.$get('/rcms-api/1/check_answer'),\n    };\n  },\n  methods: {\n    async handleOnSubmit() {\n      \u30fb\u30fb\u30fb\n      Submit the form here\n      \u30fb\u30fb\u30fb\n    }\n  }\n};\n<\/script>\n")),(0,a.kt)("h4",{id:"disable-submit-button-when-the-form-has-been-answered"},"Disable submit button when the form has been answered"),(0,a.kt)("p",null,"To disable the form submit button when the form has been answered but keep the form items displayed, modify the button section as follows:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-markup"},"<template>\n  <div>\n    <form>\n      \x3c!-- ... --\x3e\n      \x3c!-- display form items ... --\x3e\n      \x3c!-- ... --\x3e\n      <button v-if=\"hadSubmitted.pageInfo.totalCnt == 0\" @click.prevent=\"handleOnSubmit\">\n        Submit\n      </button>\n      <button v-else disabled>\n        Answered\n      </button>\n    </form>\n  </div>\n</template>\n\n<script>\nexport default {\n  async asyncData({ $axios }) {\n    return {\n      response: await $axios.$get('/rcms-api/1/inquiry/1'),\n      hadSubmitted: await $axios.$get('/rcms-api/1/check_answer'),\n    };\n  },\n  methods: {\n    async handleOnSubmit() {\n      \x3c!-- ... --\x3e\n      \x3c!-- form submission process ... --\x3e\n      \x3c!-- ... --\x3e\n    }\n  }\n};\n<\/script>\n")),(0,a.kt)("h4",{id:"return-an-error-when-the-form-is-already-answered-during-form-submission"},"Return an error when the form is already answered during form submission"),(0,a.kt)("p",null,"To check for double answers when submitting the form, modify the code as follows:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-markup"},"<template>\n  <div>\n    <form>\n      \x3c!-- ... --\x3e\n      \x3c!-- display form items ... --\x3e\n      \x3c!-- ... --\x3e\n    </form>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      error: null,\n    }\n  },\n  async asyncData({ $axios }) {\n    return {\n      response: await $axios.$get('/rcms-api/1/inquiry/1'),\n    };\n  },\n  methods: {\n    async handleOnSubmit() {\n      const hadSubmitted = await this.$axios.$get('/rcms-api/1/check_answer')\n      if (hadSubmitted.pageInfo.totalCnt == 0){\n        \x3c!-- ... --\x3e\n        \x3c!-- form submission process ... --\x3e\n        \x3c!-- ... --\x3e\n      }\n      else{\n        this.error = \"Already answered\";\n      }\n    }\n  }\n};\n<\/script>\n")),(0,a.kt)("h2",{id:"related-documentation"},"Related documentation"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/docs/tutorials/setting-up-inquiry-forms/"},"Setting up inquiry forms with Kuroco and Nuxt.js"))))}u.isMDXComponent=!0}}]);