"use strict";(self.webpackChunkkurokuro=self.webpackChunkkurokuro||[]).push([[12255],{3905:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>m});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=a.createContext({}),p=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},l=function(e){var t=p(e.components);return a.createElement(c.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},g=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,c=e.parentName,l=r(e,["components","mdxType","originalType","parentName"]),u=p(n),g=i,m=u["".concat(c,".").concat(g)]||u[g]||d[g]||o;return n?a.createElement(m,s(s({ref:t},l),{},{components:n})):a.createElement(m,s({ref:t},l))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,s=new Array(o);s[0]=g;var r={};for(var c in t)hasOwnProperty.call(t,c)&&(r[c]=t[c]);r.originalType=e,r[u]="string"==typeof e?e:i,s[1]=r;for(var p=2;p<o;p++)s[p]=n[p];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},13433:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(67294);function i(e){let{faqs:t=[]}=e;if(0===(Array.isArray(t)?t.filter((e=>e.question&&e.answer)):[]).length)return null;const n={"@context":"https://schema.org","@type":"FAQPage",mainEntity:t.map((e=>({"@type":"Question",name:e.question,acceptedAnswer:{"@type":"Answer",text:e.answer}})))},i=JSON.stringify(n,null,2);return a.createElement("script",{type:"application/ld+json"},i)}},29647:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>r,default:()=>g,frontMatter:()=>s,metadata:()=>c,toc:()=>l});var a=n(87462),i=(n(67294),n(3905)),o=n(13433);const s={title:"Is there any way to reduce API requests when generating pages in Nuxt.js SSG?",description:"It is possible to generate unlinked pages by setting the routes option in the generate property of nuxt.config.js",category:"howto"},r=void 0,c={unversionedId:"faq/can-i-use-nuxt-js-ssg-to-reduce-api-calls",id:"faq/can-i-use-nuxt-js-ssg-to-reduce-api-calls",title:"Is there any way to reduce API requests when generating pages in Nuxt.js SSG?",description:"It is possible to generate unlinked pages by setting the routes option in the generate property of nuxt.config.js",source:"@site/docs/faq/can-i-use-nuxt-js-ssg-to-reduce-api-calls.mdx",sourceDirName:"faq",slug:"/faq/can-i-use-nuxt-js-ssg-to-reduce-api-calls",permalink:"/docs/faq/can-i-use-nuxt-js-ssg-to-reduce-api-calls",draft:!1,editUrl:"https://github.com/diverta/kuroco-documents/tree/main/packages/create-docusaurus/templates/shared/docs/faq/can-i-use-nuxt-js-ssg-to-reduce-api-calls.mdx",tags:[],version:"current",frontMatter:{title:"Is there any way to reduce API requests when generating pages in Nuxt.js SSG?",description:"It is possible to generate unlinked pages by setting the routes option in the generate property of nuxt.config.js",category:"howto"},sidebar:"faqSidebar",previous:{title:"Can pages without internal links be generated with Nuxt.js SSG?",permalink:"/docs/faq/can-i-use-nuxt-js-ssg-to-generate-pages-that-are-not-linked-in-the-page"},next:{title:"Can I use the admin panel with Internet Explorer 11?",permalink:"/docs/faq/can-i-use-the-admin-panel-with-internet-explorer-11"}},p={},l=[{value:"Reduce page requests sample",id:"reduce-page-requests-sample",level:2},{value:"Set <code>routes</code> option to reduce page requests",id:"set-routes-option-to-reduce-page-requests",level:3},{value:"Modifying nuxt.config",id:"modifying-nuxtconfig",level:4},{value:"Modifying the content detail page",id:"modifying-the-content-detail-page",level:4}],u={toc:l},d="wrapper";function g(e){let{components:t,...n}=e;return(0,i.kt)(d,(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)(o.Z,{faqs:[{question:"Is there any way to reduce API requests when generating pages in Nuxt.js SSG?",answer:"It is possible to generate unlinked pages by setting the routes option in the generate property of nuxt.config.js"}],mdxType:"StructuredDataFaqs"}),(0,i.kt)("p",null,"It is possible to reduce the number of requests for a page by setting the ",(0,i.kt)("inlineCode",{parentName:"p"},"routes")," option in the ",(0,i.kt)("inlineCode",{parentName:"p"},"generate")," property in nuxt.config.js."),(0,i.kt)("p",null,"The following example will explain how how to reduce API requests on a page.\nFor this practice, it is assumed that a content list page and content detail page has already been set up."),(0,i.kt)("h2",{id:"reduce-page-requests-sample"},"Reduce page requests sample"),(0,i.kt)("p",null,"This section will introduce the sample code to reduce page requests.",(0,i.kt)("br",{parentName:"p"}),"\n","We will assume a case in which a large number of slug components use ",(0,i.kt)("inlineCode",{parentName:"p"},"asyncData()")," to retrieve data from the API.",(0,i.kt)("br",{parentName:"p"}),"\n","The API will be accessed and the pages will be generated for the number of components during SSG.  "),(0,i.kt)("p",null,"It may be possible to reduce the number of API accesses to the target, making it more efficient by first acquiring data centrally in one place and then distributing the acquired data to each component.\nFor example, assume a case where the content list page and content detail page are created with the following file structure and source code."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-markup",metastring:'title="Topics list"',title:'"Topics','list"':!0},'<template>\n    <div>\n        <nuxt-link\n            v-for="topic in topics"\n            :key="topic.topics_id"\n            :to="`/topics/${topic.topics_id}`"\n        >\n            {{ topic.subject }}\n        </nuxt-link>\n    </div>\n</template>\n\n<script>\n// TopicsList page\n// /pages/topics/index.vue\nexport default {\n    async asyncData ({ $axios }) {\n        return { topics: (await $axios.$get(`${process.env.BASE_URL}/rcms-api/1/topics/`)).list }\n    }\n}\n<\/script>\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-markup",metastring:'title="Topics detail"',title:'"Topics','detail"':!0},'<template>\n    <div>\n        <h1 class="title">{{ topic.subject }}</h1>\n        <div class="post" v-html="topic.contents"></div>\n    </div>\n</template>\n\n<script>\n// TopicsDetail page\n// /pages/topics/_slug.vue\nexport default {\n    // calls 100 times on static generation if the topics contains 100 items\n    async asyncData ({ $axios, params }) {\n        return { topic: (await $axios.$get(`${process.env.BASE_URL}/rcms-api/1/topicsdetail/${params.slug}`)).details }\n    }\n}\n<\/script>\n')),(0,i.kt)("p",null,"In the above source code, if 100 contents exist, 100 requests are made to the content details API.\nHowever, in reality, only ",(0,i.kt)("inlineCode",{parentName:"p"},"title")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"contents")," are used from the content details.\nIn this case, there is no need to request the API for content details in the first place, since these data are included in the data obtained from the content list."),(0,i.kt)("h3",{id:"set-routes-option-to-reduce-page-requests"},"Set ",(0,i.kt)("inlineCode",{parentName:"h3"},"routes")," option to reduce page requests"),(0,i.kt)("p",null,"To make it more efficient, modify the system to retrieve data for content listings only once and deploy that data to each component."),(0,i.kt)("h4",{id:"modifying-nuxtconfig"},"Modifying nuxt.config"),(0,i.kt)("p",null,"First, modify nuxt.config.js as follows."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript",metastring:"[nuxt.config.js]","[nuxt.config.js]":!0},"require('dotenv').config();\nconst { BASE_URL } = process.env;\nimport axios from 'axios';\n\nmodule.exports = {\n  generate: {\n    async routes() {\n      const topicsList = (await axios.get(`${process.env.BASE_URL}/rcms-api/1/topics`)).data.list;\n      return topicsList.map((topic) => ({\n        route: `/topics/${topic.topics_id}`,  // a path of TopicsDetail\n        payload: topic  // destributes topic data to the target component (TopicsDetail)\n      }))\n    }\n  },\n")),(0,i.kt)("h4",{id:"modifying-the-content-detail-page"},"Modifying the content detail page"),(0,i.kt)("p",null,"Next, modify the content detail page as follows."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-diff",metastring:"[Topics detail]","[Topics":!0,"detail]":!0},'<template>\n    <div>\n        <h1 class="title">{{ topic.subject }}</h1>\n        <div class="post" v-html="topic.contents"></div>\n    </div>\n</template>\n\n<script>\n// TopicsDetail page\n// /pages/topics/_slug.vue\nexport default {\n-    async asyncData ({ $axios, params }) {\n-        // calls 100 times on static generation if the topics contains 100 items\n+    async asyncData ({ $axios, params, payload }) {\n+        // conveys the topic data as `payload`\n+        if (payload) {\n+            return { topic: payload };\n+        }\n+        // now that we don\'t use bellow any longer on static generation, but remain it just in case of local dev\n        return { topic: (await $axios.$get(`${process.env.BASE_URL}/rcms-api/1/topicsdetail/${params.slug}`)).details }\n    }\n}\n<\/script>\n')),(0,i.kt)("p",null,"After the above modification, the content detail page in SSG will receive zero requests, and 100 requests for content details will not be made.",(0,i.kt)("br",{parentName:"p"}),"\n","As a result, the content generation process by SSG will be shortened."),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"When checking in the local environment, run ",(0,i.kt)("inlineCode",{parentName:"p"},"npx nuxt generate && npx nuxt serve")," on the terminal.")),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"For more information about routes in nuxt.config.js, please refer to ",(0,i.kt)("a",{parentName:"p",href:"https://nuxtjs.org/docs/configuration-glossary/configuration-generate/#routes"},"Nuxt Official Documentation -> routes"),".")))}g.isMDXComponent=!0}}]);