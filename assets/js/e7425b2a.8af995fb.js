"use strict";(self.webpackChunkkurokuro=self.webpackChunkkurokuro||[]).push([[6844],{3905:(t,e,a)=>{a.d(e,{Zo:()=>s,kt:()=>h});var n=a(67294);function r(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function i(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function o(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?i(Object(a),!0).forEach((function(e){r(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function l(t,e){if(null==t)return{};var a,n,r=function(t,e){if(null==t)return{};var a,n,r={},i=Object.keys(t);for(n=0;n<i.length;n++)a=i[n],e.indexOf(a)>=0||(r[a]=t[a]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)a=i[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}var m=n.createContext({}),p=function(t){var e=n.useContext(m),a=e;return t&&(a="function"==typeof t?t(e):o(o({},e),t)),a},s=function(t){var e=p(t.components);return n.createElement(m.Provider,{value:e},t.children)},c="mdxType",d={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},g=n.forwardRef((function(t,e){var a=t.components,r=t.mdxType,i=t.originalType,m=t.parentName,s=l(t,["components","mdxType","originalType","parentName"]),c=p(a),g=r,h=c["".concat(m,".").concat(g)]||c[g]||d[g]||i;return a?n.createElement(h,o(o({ref:e},s),{},{components:a})):n.createElement(h,o({ref:e},s))}));function h(t,e){var a=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var i=a.length,o=new Array(i);o[0]=g;var l={};for(var m in e)hasOwnProperty.call(e,m)&&(l[m]=e[m]);l.originalType=t,l[c]="string"==typeof t?t:r,o[1]=l;for(var p=2;p<i;p++)o[p]=a[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}g.displayName="MDXCreateElement"},56054:(t,e,a)=>{a.r(e),a.d(e,{assets:()=>m,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var n=a(87462),r=(a(67294),a(3905));const i={title:"Generate thumbnail image from the first page of a PDF using Batch Processs",description:"This tutorial explains how to automatically make the first page of a PDF into a thumbnail image when the PDF is registered as content."},o=void 0,l={unversionedId:"tutorials/how-to-make-thumb-from-pdf",id:"tutorials/how-to-make-thumb-from-pdf",title:"Generate thumbnail image from the first page of a PDF using Batch Processs",description:"This tutorial explains how to automatically make the first page of a PDF into a thumbnail image when the PDF is registered as content.",source:"@site/docs/tutorials/how-to-make-thumb-from-pdf.md",sourceDirName:"tutorials",slug:"/tutorials/how-to-make-thumb-from-pdf",permalink:"/docs/tutorials/how-to-make-thumb-from-pdf",draft:!1,editUrl:"https://github.com/diverta/kuroco-documents/tree/main/packages/create-docusaurus/templates/shared/docs/tutorials/how-to-make-thumb-from-pdf.md",tags:[],version:"current",frontMatter:{title:"Generate thumbnail image from the first page of a PDF using Batch Processs",description:"This tutorial explains how to automatically make the first page of a PDF into a thumbnail image when the PDF is registered as content."},sidebar:"documentationSidebar",previous:{title:"Scheduled generation of screenshot PDFs of external sites",permalink:"/docs/tutorials/how-to-use-generate-pdf"},next:{title:"Creating daily backup data in CSV using Batch Process",permalink:"/docs/tutorials/how-to-implement-batch-function-exports-csv"}},m={},p=[{value:"Before you start",id:"before-you-start",level:2},{value:"Creating content structure",id:"creating-content-structure",level:2},{value:"API Configuration",id:"api-configuration",level:2},{value:"API Security Configuration",id:"api-security-configuration",level:3},{value:"Creating Endpoints",id:"creating-endpoints",level:3},{value:"Creating the &quot;get contents without thumbnail images&quot; endpoint",id:"creating-the-get-contents-without-thumbnail-images-endpoint",level:4},{value:"Creating the &quot;Update Thumbnail Image&quot; endpoint",id:"creating-the-update-thumbnail-image-endpoint",level:4},{value:"Creating a temporary storage folder",id:"creating-a-temporary-storage-folder",level:2},{value:"Creating batch process",id:"creating-batch-process",level:2},{value:"Creating the &quot;Generate Thumbnail Image from PDF&quot; Batch Process",id:"creating-the-generate-thumbnail-image-from-pdf-batch-process",level:3},{value:"Creating the &quot;Registering Generated Thumbnail Images to Content&quot; batch process",id:"creating-the-registering-generated-thumbnail-images-to-content-batch-process",level:3},{value:"Operational verification",id:"operational-verification",level:2}],s={toc:p},c="wrapper";function d(t){let{components:e,...a}=t;return(0,r.kt)(c,(0,n.Z)({},s,a,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Description of how to automatically create a thumbnail image of the first page of a PDF file when registering it as content using batch process."),(0,r.kt)("h2",{id:"before-you-start"},"Before you start"),(0,r.kt)("p",null,"The thumbnail image will be saved in GCS, so you need to integrate your Kuroco account with Firebase in advance.\nPlease refer to ",(0,r.kt)("a",{parentName:"p",href:"/docs/tutorials/firebase/"},"Cloud storage integration with Firebase")," to integrate with Firebase."),(0,r.kt)("h2",{id:"creating-content-structure"},"Creating content structure"),(0,r.kt)("p",null,"First, create a content structure to register the PDF file. Click ","[Content structure]"," from the menu to open the content structure list screen, and then click ","[Add]","."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/2a8704d4dc2ef57a0d82495cb0904bbc.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/2a8704d4dc2ef57a0d82495cb0904bbc.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Create it as follows this time."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Field Name"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Setting"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Name"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Auto thumbnail generation")))),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/e590a81bc69259e76eba0dd9c7dd3299.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/e590a81bc69259e76eba0dd9c7dd3299.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Also, add the following two fields:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"ID"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Field Name"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Identifier"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Field Settings"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"1"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Thumbnail image"),(0,r.kt)("td",{parentName:"tr",align:"left"},"image"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Image (upload to KurocoFiles)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"2"),(0,r.kt)("td",{parentName:"tr",align:"left"},"PDF file"),(0,r.kt)("td",{parentName:"tr",align:"left"},"pdf"),(0,r.kt)("td",{parentName:"tr",align:"left"},"File (upload to KurocoFiles)")))),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/7e647197e743e0fb8a233d472c6b716f.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/7e647197e743e0fb8a233d472c6b716f.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Once you have made the settings, click ","[Add]"," to save the content structure."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/ace4c326c1156949fa7df50432f9704c.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/ace4c326c1156949fa7df50432f9704c.png",alt:"Image from Gyazo"})),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"For more information on creating content structure, please refer to the tutorial, ",(0,r.kt)("a",{parentName:"p",href:"/docs/tutorials/adding-a-topics/"},"Creating content structure"),".")),(0,r.kt)("h2",{id:"api-configuration"},"API Configuration"),(0,r.kt)("p",null,"Next, configure the API to convert the PDF to an image.\nClick ","[API]"," -> ","[Default]"," from the menu to open the endpoint list screen, and then click ","[Add]","."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/88c008c487d8246aa8f28897bf293e98.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/88c008c487d8246aa8f28897bf293e98.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"The API add screen will be displayed, so configure it as follows and click ","[Add]","."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Setting"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Title"),(0,r.kt)("td",{parentName:"tr",align:"left"},"pdf-to-thumbs")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Version"),(0,r.kt)("td",{parentName:"tr",align:"left"},"1.0")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("td",{parentName:"tr",align:"left"},"auto Thumbnail generation")))),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/b60cdcea70624088ec0f779b0ad05640.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/b60cdcea70624088ec0f779b0ad05640.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"The endpoint list screen for the created API will be displayed."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/2893f2c43cdc2a5da16c4098e6528ebf.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/2893f2c43cdc2a5da16c4098e6528ebf.png",alt:"Image from Gyazo"})),(0,r.kt)("h3",{id:"api-security-configuration"},"API Security Configuration"),(0,r.kt)("p",null,'Configure the API security settings. For this API, select "Dynamic Access Token" to prevent requests from external sources.'),(0,r.kt)("p",null,"From the endpoint list screen, click on ","[Security]","."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/c06690fa4d1cbfdf0acf8a0e31a90b99.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/c06690fa4d1cbfdf0acf8a0e31a90b99.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Select ","[Dynamic Access Token]"," from the security settings, and then click ","[Save]","."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/9fee8354c78aef6d3f4824043ba7d996.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/9fee8354c78aef6d3f4824043ba7d996.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Next, you need to create endpoints. "),(0,r.kt)("h3",{id:"creating-endpoints"},"Creating Endpoints"),(0,r.kt)("p",null,"You will create two endpoints this time"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Get contents that have no thumbnail images registered."),(0,r.kt)("li",{parentName:"ul"},"Update thumbnail image.")),(0,r.kt)("p",null,'In "Get contents that have no thumbnail images registered" endpoint, check whether the content has a registered thumbnail image, and if not, register a thumbnail image for the content with "Update thumbnail image" endpoint.'),(0,r.kt)("h4",{id:"creating-the-get-contents-without-thumbnail-images-endpoint"},'Creating the "get contents without thumbnail images" endpoint'),(0,r.kt)("p",null,'First, let\'s create an endpoint to "get the contents with no thumbnail images". Click ',"[Add new endpoint]"," on the endpoint list screen."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/05b1178354d67bfea4deb9fff2235c17.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/05b1178354d67bfea4deb9fff2235c17.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"We will create the endpoint as follows:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,r.kt)("th",{parentName:"tr",align:"left"}),(0,r.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Path"),(0,r.kt)("td",{parentName:"tr",align:"left"}),(0,r.kt)("td",{parentName:"tr",align:"left"},"no-thumb-list")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Category"),(0,r.kt)("td",{parentName:"tr",align:"left"}),(0,r.kt)("td",{parentName:"tr",align:"left"},"Content")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Model"),(0,r.kt)("td",{parentName:"tr",align:"left"}),(0,r.kt)("td",{parentName:"tr",align:"left"},"Topics")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Operation"),(0,r.kt)("td",{parentName:"tr",align:"left"}),(0,r.kt)("td",{parentName:"tr",align:"left"},"list")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Basic settings"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Filter"),(0,r.kt)("td",{parentName:"tr",align:"left"},'image="" and pdf!=""',(0,r.kt)("br",null),"(Note: searching by text presence or absence in PDF file names/image descriptions)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Basic settings"),(0,r.kt)("td",{parentName:"tr",align:"left"},"topics_group_id"),(0,r.kt)("td",{parentName:"tr",align:"left"},'Enter the ID of "Auto thumbnail generation" created earlier')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Basic settings"),(0,r.kt)("td",{parentName:"tr",align:"left"},"cnt"),(0,r.kt)("td",{parentName:"tr",align:"left"},"0")))),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/e45463ae37c0591f38a752ae71ba8690.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/e45463ae37c0591f38a752ae71ba8690.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"After the settings are configured, click the ","[Add]"," button at the bottom to save your changes."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/7db931d0f87502509e5bb796844c9a1d.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/7db931d0f87502509e5bb796844c9a1d.png",alt:"Image from Gyazo"})),(0,r.kt)("h4",{id:"creating-the-update-thumbnail-image-endpoint"},'Creating the "Update Thumbnail Image" endpoint'),(0,r.kt)("p",null,'Next, we will create the "Update Thumbnail Image" endpoint. Similarly, click "Add new endpoint" on the endpoint list screen, and create as follows:'),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Item"),(0,r.kt)("th",{parentName:"tr",align:"left"}),(0,r.kt)("th",{parentName:"tr",align:"left"},"Content"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"}),(0,r.kt)("td",{parentName:"tr",align:"left"},"Path"),(0,r.kt)("td",{parentName:"tr",align:"left"})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Category"),(0,r.kt)("td",{parentName:"tr",align:"left"}),(0,r.kt)("td",{parentName:"tr",align:"left"},"Contents")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Model"),(0,r.kt)("td",{parentName:"tr",align:"left"}),(0,r.kt)("td",{parentName:"tr",align:"left"},"Topics")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Operation"),(0,r.kt)("td",{parentName:"tr",align:"left"}),(0,r.kt)("td",{parentName:"tr",align:"left"},"update")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Basic Settings"),(0,r.kt)("td",{parentName:"tr",align:"left"},"topics_group_id"),(0,r.kt)("td",{parentName:"tr",align:"left"},'Specify the ID of the "Automated Thumbnail Creation" created earlier')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Basic Settings"),(0,r.kt)("td",{parentName:"tr",align:"left"},"use_columns"),(0,r.kt)("td",{parentName:"tr",align:"left"},"image")))),(0,r.kt)("p",null,"After setting, click ","[Add]"," at the bottom of the screen."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/778af863ecea4ea501c08da3b3255a10.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/778af863ecea4ea501c08da3b3255a10.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"After the settings are configured, click the ","[Add]"," button at the bottom to save your changes."),(0,r.kt)("p",null,"That completes the creation of the endpoints."),(0,r.kt)("h2",{id:"creating-a-temporary-storage-folder"},"Creating a temporary storage folder"),(0,r.kt)("p",null,"Next, create a folder to store the images. This folder will be used as a temporary storage location after saving the PDF as a thumbnail image."),(0,r.kt)("p",null,"Click ","[File manager]"," from the menu."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/612de529fb73f1a3bb1cf2c1340c7a01.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/612de529fb73f1a3bb1cf2c1340c7a01.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Click on ","[GCS(Private)]"," and then click on ","[New subfolder]"," to create a new folder."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/fa9bb7d7a7c5606916095f4e324104bb.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/fa9bb7d7a7c5606916095f4e324104bb.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,'Enter "pdf_thumb" as the folder name, and click ',"[OK]","."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/7452cdf7f3708d4b53f797b0ab148d9b.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/7452cdf7f3708d4b53f797b0ab148d9b.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,'"pdf_thumb" folder has been created.'),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/63cc7e8fbbe192434779da38de3c8e0a.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/63cc7e8fbbe192434779da38de3c8e0a.png",alt:"Image from Gyazo"})),(0,r.kt)("h2",{id:"creating-batch-process"},"Creating batch process"),(0,r.kt)("p",null,"Next, we will create batch process to convert PDF files into images. We will create the following two batch process:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Generate a thumbnail image from a PDF",(0,r.kt)("br",{parentName:"li"}),"This batch process converts the first page of a PDF into an image."),(0,r.kt)("li",{parentName:"ul"},"Register the generated thumbnail images as content",(0,r.kt)("br",{parentName:"li"}),"This batch process registers the created thumbnail images as content for the target.")),(0,r.kt)("h3",{id:"creating-the-generate-thumbnail-image-from-pdf-batch-process"},'Creating the "Generate Thumbnail Image from PDF" Batch Process'),(0,r.kt)("p",null,'First, let\'s create the "Generate Thumbnail Image from PDF" batch process.\nClick ',"[Add]"," under ","[Operation]"," -> ","[Batch process]","."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/7eea38b8a0213f660d373fb52e120bb4.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/7eea38b8a0213f660d373fb52e120bb4.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Configure the following on the batch process editor."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Item"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Setting"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Title"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Thumbnail images generation from PDF")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Identifier"),(0,r.kt)("td",{parentName:"tr",align:"left"},"create_thumb")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Batch"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Hourly")))),(0,r.kt)("p",null,"Next, enter the following in the execution contents."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-smarty"},"{*Get a list of contents without thumbnails that have been registered as PDF.*}\n{api_internal member_id=1 endpoint='/rcms-api/2/no-thumb-list' query='' method='GET' var='contents_list' status_var='status'}\n{if $status == 1 && $contents_list.list|@count > 0}\n    {foreach from=$contents_list.list key=idx item=item}\n        {if !$item.image.url && $item.pdf.url}{*Image not set.*}\n            {get_file url=$item.pdf.url var=temp_path save=1}\n            {if $temp_path}\n                {assign var=gcp_pdf_path value='files/g/private/pdf_thumb/'|cat:$item.topics_id|cat:'.pdf'}\n                {assign var=gcp_img_path value='files/g/private/pdf_thumb/'|cat:$item.topics_id|cat:'.png'}\n                {*Save the PDF file to a temporary directory on GCS.*}\n                {put_file tmp_path=$temp_path path=$gcp_pdf_path}\n                {assign var=data value=null}\n                {assign_array var=data values=''}\n                {assign var=data.topics_id value=$item.topics_id}\n                {assign var=data.pdf value=$item.pdf}\n                {*Generate thumbnails using the functionality of Cloud Functions.*}\n                {make_pdf_thumb pdfPath=$gcp_pdf_path destPath=$gcp_img_path callback_batch='update_pdf_thumb_bat' data=$data}\n            {/if}\n        {/if}\n    {/foreach}\n{/if}\n")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Please replace the ",(0,r.kt)("inlineCode",{parentName:"p"},"2")," in ",(0,r.kt)("inlineCode",{parentName:"p"},"/rcms-api/2/no-thumb-list")," with the ID of the API you just created. You can confirm the ID of the API from the URL of the endpoint list page. ")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/29f95510ed448d9fef882f0dc4d43bd7.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/29f95510ed448d9fef882f0dc4d43bd7.png",alt:"Image from Gyazo"}),"  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/9d4a51d933f29a36987b04cd420cfe4c.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/9d4a51d933f29a36987b04cd420cfe4c.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Once you have finished configuring the settings, click ","[Add]"," to save the batch process."),(0,r.kt)("h3",{id:"creating-the-registering-generated-thumbnail-images-to-content-batch-process"},'Creating the "Registering Generated Thumbnail Images to Content" batch process'),(0,r.kt)("p",null,'Next, create the "Registering Generated Thumbnail Images to Content" batch process.',(0,r.kt)("br",{parentName:"p"}),"\n","Similar to previous step, we will add it using the batch process editor with the following settings."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Item"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Setting"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Title"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Register image to content")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Identifier"),(0,r.kt)("td",{parentName:"tr",align:"left"},"update_pdf_thumb_bat")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Batch"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Batch Template")))),(0,r.kt)("p",null,"Next, enter the following information in the execution contents."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-smarty"},"{*Set the data obtained from Cloud Functions.*}\n{assign var=topics_id value=$ext_data.data.topics_id}\n{assign var=image_name value=$ext_data.data.pdf.desc|replace:'.pdf':''}\n{assign var=dest_path value=$ext_data.destPath}\n{assign var=file_id value='files/temp/pdf_thumb/'|cat:$topics_id|cat:'.png'}\n{assign var=save_path value='/files/temp/pdf_thumb/'|cat:$topics_id|cat:'.png'}\n\n{*Get the image file from GCS to \"files/temp\".*}\n{get_file path=$dest_path save_path=$save_path save=1}\n\n{*Upload the obtained image to the content.*}\n{assign_array var=post_data values=''}\n{assign_array var=post_data.image values=''}\n{assign var=post_data.image.file_id value=$file_id}\n{assign var=post_data.image.file_nm value=$image_name|cat:'.png'}\n{assign var=post_data.image.desc value=$image_name}\n{api_internal endpoint='/rcms-api/2/thumb-update/'|cat:$topics_id member_id=1 method='POST' queries=$post_data var='resp' status_var='status'}\n{if $status==1}\n    {*Delete the PDF and thumbnail upon successful processing.*}\n    {remove_file path='/'|cat:$dest_path}\n    {remove_file path='/'|cat:$dest_path|replace:'.png':'.pdf'}\n{/if}\n")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Please change ",(0,r.kt)("inlineCode",{parentName:"p"},"2")," in ",(0,r.kt)("inlineCode",{parentName:"p"},"/rcms-api/2/thumb-update")," to the ID of the API that you created earlier. You can confirm the API ID from the URL of the endpoint list page.")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/a317a701e1a21677e0ba4898c52199c8.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/a317a701e1a21677e0ba4898c52199c8.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"The batch process configurations are now complete."),(0,r.kt)("h2",{id:"operational-verification"},"Operational verification"),(0,r.kt)("p",null,"Finally, let's perform an operational verification of the settings."),(0,r.kt)("p",null,'Create content from the  "Auto thumbnail generation" content structure by uploading only the PDF file without uploading any images.'),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/7f28ff06e0caaa482aa4d06a2907901a.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/7f28ff06e0caaa482aa4d06a2907901a.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"After uploading the PDF, click on ","[Add]"," to create the content."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/7c3062cc754ed1b9c15c82af5af2473c.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/7c3062cc754ed1b9c15c82af5af2473c.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Next, let's run the batch process.",(0,r.kt)("br",{parentName:"p"}),"\n","Although the settings are configured to run the batch process every hour, for testing purposes, we will run it manually."),(0,r.kt)("p",null,"Click on ","[Thumbnail images generation from PDF]"," that was created earlier from the batch process."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/ac12266021b4471a485e7bc2d4ca3b3f.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/ac12266021b4471a485e7bc2d4ca3b3f.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Click on ","[Run now]"," next to the title."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/d59a8f356f228111d21bd60e6049bc7d.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/d59a8f356f228111d21bd60e6049bc7d.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"When the alert appears, click on ","[OK]"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/45853129111ca7e114cdb686264fce08.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/45853129111ca7e114cdb686264fce08.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"The batch has been executed."),(0,r.kt)("p",null,"Next, let's check if the images have been uploaded to the content."),(0,r.kt)("p",null,"Click on ","[Content structure]"," and then click on ","[List]",' for the "Automatic thumbnail generation".'),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/37a174c245b17e733b47cb18144f8bce.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/37a174c245b17e733b47cb18144f8bce.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Click on the content that was created earlier."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/305e8f795acf754a40be02811dd76b07.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/305e8f795acf754a40be02811dd76b07.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,'You should be able to confirm that an image has been registered in the "Thumbnail image" field.'),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/bdc53fc5c5412ef02a2e16ae94a2e3a4.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/bdc53fc5c5412ef02a2e16ae94a2e3a4.png",alt:"Image from Gyazo"})),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"It may take several minutes for the image to be created. If the image has not been registered, please wait for some time and check again.")))}d.isMDXComponent=!0}}]);