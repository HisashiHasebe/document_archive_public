"use strict";(self.webpackChunkkurokuro=self.webpackChunkkurokuro||[]).push([[14350],{3905:(e,t,a)=>{a.d(t,{Zo:()=>l,kt:()=>g});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},l=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,l=c(e,["components","mdxType","originalType","parentName"]),u=p(a),d=r,g=u["".concat(s,".").concat(d)]||u[d]||m[d]||o;return a?n.createElement(g,i(i({ref:t},l),{},{components:a})):n.createElement(g,i({ref:t},l))}));function g(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=d;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c[u]="string"==typeof e?e:r,i[1]=c;for(var p=2;p<o;p++)i[p]=a[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},22366:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>c,toc:()=>p});var n=a(87462),r=(a(67294),a(3905));const o={title:"How to restrict API access with Static Access Token",category:"API",weight:1},i=void 0,c={unversionedId:"tutorials/restricting-api-access-with-statictoken",id:"tutorials/restricting-api-access-with-statictoken",title:"How to restrict API access with Static Access Token",description:"Kuroco's API security",source:"@site/docs/tutorials/restricting-api-access-with-statictoken.md",sourceDirName:"tutorials",slug:"/tutorials/restricting-api-access-with-statictoken",permalink:"/docs/tutorials/restricting-api-access-with-statictoken",draft:!1,editUrl:"https://github.com/diverta/kuroco-documents/tree/main/packages/create-docusaurus/templates/shared/docs/tutorials/restricting-api-access-with-statictoken.md",tags:[],version:"current",frontMatter:{title:"How to restrict API access with Static Access Token",category:"API",weight:1},sidebar:"documentationSidebar",previous:{title:"How to check the API security using Swagger UI",permalink:"/docs/tutorials/how-to-use-swagger-ui"},next:{title:"How to get the origin country/region of API requests",permalink:"/docs/tutorials/how-to-add-region-data"}},s={},p=[{value:"Kuroco&#39;s API security",id:"kurocos-api-security",level:2},{value:"How to restrict API access by Static Access Token",id:"how-to-restrict-api-access-by-static-access-token",level:2},{value:"Reference",id:"reference",level:2}],l={toc:p},u="wrapper";function m(e){let{components:t,...a}=e;return(0,r.kt)(u,(0,n.Z)({},l,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"kurocos-api-security"},"Kuroco's API security"),(0,r.kt)("p",null,"You have following 4 options for Kuroco's API security:  "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"None"),(0,r.kt)("li",{parentName:"ul"},"Static Access Token"),(0,r.kt)("li",{parentName:"ul"},"Dynamic Access Token"),(0,r.kt)("li",{parentName:"ul"},"Cookie")),(0,r.kt)("p",null,'You can set "None" if you want to create and test a temporary development API, or if you want to use completely open data.\n',(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/efb08ca3c9f21c088796adf02dcf073c.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/efb08ca3c9f21c088796adf02dcf073c.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,'However, if you set the API security setting to "None", anyone can use the API, and it will be possible to accept API requests indiscriminately from the outside.  '),(0,r.kt)("p",null,"If this situation is not as expected, you can use the Static Access Token function to impose some restrictions.\nThis tutorial explains how to apply access restrictions using Static Access Token.  "),(0,r.kt)("p",null,"Note:",(0,r.kt)("br",{parentName:"p"}),"\n","The character string of StaticToken becomes information that can be viewed from the outside by referring to the network communication of the public site and the description in the JS file. Therefore, if you want to restrict secure information, please do so by restricting login authentication by Dynamic Token / Cookie restriction instead of Static Access Token or by restricting API by browsing group.  "),(0,r.kt)("h2",{id:"how-to-restrict-api-access-by-static-access-token"},"How to restrict API access by Static Access Token"),(0,r.kt)("p",null,"This section explains how to restrict API access by Static Access Token."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"1. Configure the security of Kuroco API"),(0,r.kt)("br",{parentName:"p"}),"\n","On any API list page, click ","[Security]",".",(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/a3a55f1ee37301a9df29df84ce1b4c32.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/a3a55f1ee37301a9df29df84ce1b4c32.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,'Change the "Security" to ',(0,r.kt)("inlineCode",{parentName:"p"},"Static Access Token")," and click ","[Save]","\n",(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/964db1c6f8a645fed25b777f3d2d4f1c.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/964db1c6f8a645fed25b777f3d2d4f1c.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"2.Issue Static Access Token"),(0,r.kt)("br",{parentName:"p"}),"\n","Click ","[Swagger UI]"," on the API list page.",(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/db05d2056b6b378166495c378a8a4cf9.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/db05d2056b6b378166495c378a8a4cf9.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,'Enter "Valid Until" of "Generate Static Access Token" at the top of Swagger UI page and click ',"[Generate]",".",(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/8269c6ba4d7334e2d8145d3ca0b8afad.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/8269c6ba4d7334e2d8145d3ca0b8afad.png",alt:"Image from Gyazo"})," "),(0,r.kt)("p",null,"Token will be issued. You will need it later so save it.",(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/b944eebd7c83962562324408ac7bf798.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/b944eebd7c83962562324408ac7bf798.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"The configuration on the Kuroco management page is now complete.  "),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"3. Install axios-middleware"),(0,r.kt)("br",{parentName:"p"}),"\n","Next, we will configure on the terminal.",(0,r.kt)("br",{parentName:"p"}),"\n","Open the terminal(command prompt) and install ",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/axios-middleware"},"axios-middleware"),"on the site using below command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"npm install --save axios-middleware\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"4. Add plugin on nuxt.config.js"),(0,r.kt)("br",{parentName:"p"}),"\n","Add below code in nuxt.config.js."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="nuxt.config.js"',title:'"nuxt.config.js"'},"plugins: ['@/plugins/axios']\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},'5. Create "axios.js" file in',(0,r.kt)("inlineCode",{parentName:"strong"},"plugins")," directory"),(0,r.kt)("br",{parentName:"p"}),"\n",'Create "axios.js" file in plugins directory and add below code:  '),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="/plugins/axios.js"',title:'"/plugins/axios.js"'},"import axios from 'axios'\n\nexport default function({ $axios }) {\n  $axios.onRequest((config) => {\n    config.headers['x-rcms-api-access-token'] = 'TOKEN YOU HAVE SAVED'\n    return config\n  })\n}\n")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"You can retrieve data by setting a static access token as the value for the key ",(0,r.kt)("inlineCode",{parentName:"p"},"X-RCMS-API-ACCESS-TOKEN")," in the request header and sending the request.")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"We are including the Token information in the file, but in actual projects, it is recommended to write it in other files such as ",(0,r.kt)("inlineCode",{parentName:"p"},".env")," file.  ")),(0,r.kt)("p",null,"The configuration of API access restriction by Static Access Token is now complete.  "),(0,r.kt)("h2",{id:"reference"},"Reference"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/management/api-security/"},"API Security")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/tutorials/how-to-use-swagger-ui/"},"How to check the API security using Swagger UI"))))}m.isMDXComponent=!0}}]);