"use strict";(self.webpackChunkkurokuro=self.webpackChunkkurokuro||[]).push([[86510],{3905:(t,e,a)=>{a.d(e,{Zo:()=>s,kt:()=>g});var r=a(67294);function n(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function o(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function i(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?o(Object(a),!0).forEach((function(e){n(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function p(t,e){if(null==t)return{};var a,r,n=function(t,e){if(null==t)return{};var a,r,n={},o=Object.keys(t);for(r=0;r<o.length;r++)a=o[r],e.indexOf(a)>=0||(n[a]=t[a]);return n}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)a=o[r],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(n[a]=t[a])}return n}var l=r.createContext({}),d=function(t){var e=r.useContext(l),a=e;return t&&(a="function"==typeof t?t(e):i(i({},e),t)),a},s=function(t){var e=d(t.components);return r.createElement(l.Provider,{value:e},t.children)},c="mdxType",m={inlineCode:"code",wrapper:function(t){var e=t.children;return r.createElement(r.Fragment,{},e)}},u=r.forwardRef((function(t,e){var a=t.components,n=t.mdxType,o=t.originalType,l=t.parentName,s=p(t,["components","mdxType","originalType","parentName"]),c=d(a),u=n,g=c["".concat(l,".").concat(u)]||c[u]||m[u]||o;return a?r.createElement(g,i(i({ref:e},s),{},{components:a})):r.createElement(g,i({ref:e},s))}));function g(t,e){var a=arguments,n=e&&e.mdxType;if("string"==typeof t||n){var o=a.length,i=new Array(o);i[0]=u;var p={};for(var l in e)hasOwnProperty.call(e,l)&&(p[l]=e[l]);p.originalType=t,p[c]="string"==typeof t?t:n,i[1]=p;for(var d=2;d<o;d++)i[d]=a[d];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}u.displayName="MDXCreateElement"},19252:(t,e,a)=>{a.r(e),a.d(e,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>p,toc:()=>d});var r=a(87462),n=(a(67294),a(3905));const o={title:"Integrating and setting up subscription billing with Stripe",description:"The Stripe screen enables you to configure settings for integrating Stripe into your website."},i=void 0,p={unversionedId:"tutorials/subscription-billing-with-stripe",id:"tutorials/subscription-billing-with-stripe",title:"Integrating and setting up subscription billing with Stripe",description:"The Stripe screen enables you to configure settings for integrating Stripe into your website.",source:"@site/docs/tutorials/subscription-billing-with-stripe.md",sourceDirName:"tutorials",slug:"/tutorials/subscription-billing-with-stripe",permalink:"/docs/tutorials/subscription-billing-with-stripe",draft:!1,editUrl:"https://github.com/diverta/kuroco-documents/tree/main/packages/create-docusaurus/templates/shared/docs/tutorials/subscription-billing-with-stripe.md",tags:[],version:"current",frontMatter:{title:"Integrating and setting up subscription billing with Stripe",description:"The Stripe screen enables you to configure settings for integrating Stripe into your website."},sidebar:"documentationSidebar",previous:{title:"Integrating with VAddy - Automated API endpoint diagnostics",permalink:"/docs/tutorials/integrating-with-vaddy"},next:{title:"Integrating HubSpot into Kuroco",permalink:"/docs/tutorials/integrating-hubspot-into-kuroco"}},l={},d=[{value:"Overview",id:"overview",level:2},{value:"What you&#39;ll learn",id:"what-youll-learn",level:2},{value:"Stripe integration",id:"stripe-integration",level:2},{value:"Obtaining API keys from Stripe",id:"obtaining-api-keys-from-stripe",level:3},{value:"Creating your webhook in Stripe",id:"creating-your-webhook-in-stripe",level:3},{value:"Integrating Stripe into Kuroco",id:"integrating-stripe-into-kuroco",level:3},{value:"Adding your product(s)",id:"adding-your-products",level:2},{value:"Adding Products with Stripe",id:"adding-products-with-stripe",level:3},{value:"Link Kuroco groups to Stripe products",id:"link-kuroco-groups-to-stripe-products",level:3},{value:"API setup",id:"api-setup",level:2},{value:"Endpoint configuration",id:"endpoint-configuration",level:3},{value:"Checkout endpoint",id:"checkout-endpoint",level:4},{value:"Cancellation endpoint",id:"cancellation-endpoint",level:4},{value:"Verifying the billing process",id:"verifying-the-billing-process",level:3},{value:"Verifying the subscription cancellation",id:"verifying-the-subscription-cancellation",level:3},{value:"More information",id:"more-information",level:2},{value:"Limitations",id:"limitations",level:3},{value:"Stripe CLI",id:"stripe-cli",level:3}],s={toc:d},c="wrapper";function m(t){let{components:e,...a}=t;return(0,n.kt)(c,(0,r.Z)({},s,a,{components:e,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"overview"},"Overview"),(0,n.kt)("p",null,"This tutorial explains how to integrate Stripe into Kuroco and set up recurrent billing for a fixed-price product."),(0,n.kt)("h2",{id:"what-youll-learn"},"What you'll learn"),(0,n.kt)("p",null,"The flow for the whole setup process is divided into three parts:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",{parentName:"p",href:"#stripe-integration"},"Integrating Stripe into Kuroco")),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#obtaining-api-keys-from-stripe"},"Getting the API keys from Stripe")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#creating-your-webhook-in-stripe"},"Creating a webhook in Stripe")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#integrating-stripe-into-kuroco"},"Integration setup in Kuroco")))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",{parentName:"p",href:"#adding-your-products"},"Adding your product(s)")),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#adding-products-with-stripe"},"Adding Products with Stripe")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#link-kuroco-groups-to-stripe-products"},"Link Kuroco groups to Stripe products")))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",{parentName:"p",href:"#api-setup"},"Setting up the API")),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#endpoint-configuration"},"Creating a checkout and a cancellation endpoint")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#verifying-the-billing-process"},"Verifying the checkout endpoint")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#verifying-the-subscription-cancellation"},"Verifying the cancellation endpoint"))))),(0,n.kt)("h2",{id:"stripe-integration"},"Stripe integration"),(0,n.kt)("p",null,"First, you will need to obtain the API keys and webhook from Stripe and enter them into you Kuroco admin panel."),(0,n.kt)("h3",{id:"obtaining-api-keys-from-stripe"},"Obtaining API keys from Stripe"),(0,n.kt)("p",null,"In your browser, go to the ",(0,n.kt)("a",{parentName:"p",href:"https://dashboard.stripe.com/"},"Stripe dashboard"),' and select your mode ("Developer" or "Test mode") in the upper right corner.'),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/998a7d7b6e72a9ff73336acfc1fa202f.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/998a7d7b6e72a9ff73336acfc1fa202f.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,"On the next page, select ","[API keys]"," in the left sidebar menu.",(0,n.kt)("br",{parentName:"p"}),"\n","You will see the ","[Publishable key]"," and the ","[Secret key]",". Copy them for later use."),(0,n.kt)("admonition",{type:"caution"},(0,n.kt)("p",{parentName:"admonition"},'It is important to select the correct mode for your purposes ("Developer" or "Test mode") when performing your integration, as they have different API keys. If you need to switch modes, make sure to copy the keys again and update them in your Kuroco admin panel.')),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/1463f45913a90348113701014db4208d.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/1463f45913a90348113701014db4208d.png",alt:"Image from Gyazo"})),(0,n.kt)("h3",{id:"creating-your-webhook-in-stripe"},"Creating your webhook in Stripe"),(0,n.kt)("p",null,"Next, select ","[Webhooks]"," in the side menu. On the Webhooks page, click ","[Add an endpoint]","."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/3c8abbd3fc861a4a343b3ca590460d7f.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/3c8abbd3fc861a4a343b3ca590460d7f.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,"You will be redirected to the webhook configuration page, where you will add a webhook that allows Kuroco to determine if the Stripe payment was successful."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/94aa9e09dd6d2d44b2a63a57b92cdc06.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/94aa9e09dd6d2d44b2a63a57b92cdc06.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,"Set up your webhook as follows:"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Endpoint URL"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Enter the endpoint URL found on the ",(0,n.kt)("a",{parentName:"td",href:"https://t.gyazo.com/teams/diverta/964b549bd5a684ad32048d4e6f80e72b.png"},"Kuroco Stripe screen"),".")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Description"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Enter a description for your webhook.")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Listen to"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Select ","[Events on your account]",".")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Version"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Select the latest current version of your account.")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Events"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Click ","[+ Select events]"," and select the following events from the dropdown list:",(0,n.kt)("ul",null,(0,n.kt)("li",null,(0,n.kt)("inlineCode",{parentName:"td"},"customer.subscription.created")),(0,n.kt)("li",null,(0,n.kt)("inlineCode",{parentName:"td"},"customer.subscription.deleted")),(0,n.kt)("li",null,(0,n.kt)("inlineCode",{parentName:"td"},"customer.subscription.updated"))),"Click ","[Add events]"," when you are done.")))),(0,n.kt)("p",null,"When you are done, click ","[Add endpoint]"," to add the new endpoint to your Stripe dashboard."),(0,n.kt)("p",null,"After you have added your endpoint, click ","[Reveal signing secret]"," to see the webhook secret. Copy it for later use."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/d0a520b9294b90323506c9f610630910.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/d0a520b9294b90323506c9f610630910.png",alt:"Image from Gyazo"})),(0,n.kt)("h3",{id:"integrating-stripe-into-kuroco"},"Integrating Stripe into Kuroco"),(0,n.kt)("p",null,"In Kuroco's left sidebar menu, under \u201cSETTINGS\u201d, select ","[External system integration]"," -> ","[Stripe]",".   "),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/4f920429811751b809043c3eaeaefe4c.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/4f920429811751b809043c3eaeaefe4c.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,"On the Stripe integration screen, enter the keys you copied from Stripe UI in the corresponding fields."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/d2d1503862df4a5e06adbb3bc0610128.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/d2d1503862df4a5e06adbb3bc0610128.png",alt:"Image from Gyazo"})),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Status"),(0,n.kt)("td",{parentName:"tr",align:"left"},'Select "Enable".')),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Publishable key"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Enter the publishable key you copied.")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Secret key"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Enter the secret key you copied.")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Webhook secret"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Enter the signing secret you copied.")))),(0,n.kt)("p",null,"When you are done, click ","[Update]"," to apply these changes."),(0,n.kt)("h2",{id:"adding-your-products"},"Adding your product(s)"),(0,n.kt)("p",null,"The next step is to add your product(s) in Stripe and in Kuroco.    "),(0,n.kt)("h3",{id:"adding-products-with-stripe"},"Adding Products with Stripe"),(0,n.kt)("p",null,"In the top bar menu, click ","[Products]",".",(0,n.kt)("br",{parentName:"p"}),"\n","Then, select ","[All products]"," from the left sidebar.",(0,n.kt)("br",{parentName:"p"}),"\n","On the Products page, click ","[+ Add a product]","."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/2a97ee06c256958b8ea76a502bee77d0.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/2a97ee06c256958b8ea76a502bee77d0.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,"You will be redirected to the Add product page. Fill in the details of your product as follows. For more information, refer to the ",(0,n.kt)("a",{parentName:"p",href:"https://stripe.com/docs/products-prices/manage-prices"},"Stripe docs: Manage products and prices"),"."),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Name of the product.")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Description"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Brief information of the product.")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Pricing"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Select ","[Standard pricing]",".")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Recurring"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Select ","[Recurring]",".")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Billing period"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Select your billing period (interval of time between each statement).")))),(0,n.kt)("p",null,"When you are done, click ","[Save product]"," to add your product to the Stripe database."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/d25df95fe43ed69f9fa8eaa6d7111fb2.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/d25df95fe43ed69f9fa8eaa6d7111fb2.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,'You will be redirected to the Details page. Under "Pricing", find the API ID and copy it for later use.'),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/5f018cec74aa98e71cdf383dc2a574d5.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/5f018cec74aa98e71cdf383dc2a574d5.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,'To add another product, repeat the above steps under "',(0,n.kt)("a",{parentName:"p",href:"#adding-your-product"},"Adding your product"),'".'),(0,n.kt)("h3",{id:"link-kuroco-groups-to-stripe-products"},"Link Kuroco groups to Stripe products"),(0,n.kt)("p",null,"Next, go to your Kuroco admin panel and create an empty member group for your product. If you have more than one product, each product should have a separate group.",(0,n.kt)("br",{parentName:"p"}),"\n","(For a tutorial on how to create new groups, see ",(0,n.kt)("a",{parentName:"p",href:"/docs/tutorials/how-to-make-new-group/"},"Creating groups"),".)"),(0,n.kt)("p",null,"From the group list, click the name of the group you just created."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/ae02bfe252d9c3ea7793a5208b96dad6.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/ae02bfe252d9c3ea7793a5208b96dad6.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,'On the Group editor screen, enter the API ID you copied from Stripe into "Stripe price ID".'),(0,n.kt)("admonition",{type:"tip"},(0,n.kt)("p",{parentName:"admonition"},'The "Stripe price ID" field only appears on admin panels with Stripe successfully integrated. If you do not see this field, go back to the ',(0,n.kt)("a",{parentName:"p",href:"#integrating-stripe-into-kuroco"},"integration step")," above and check if all your inputs and settings are correct.")),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/78f1935551a531aca28173a429c81e57.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/78f1935551a531aca28173a429c81e57.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,"When a member successfully completes checkout from the payment page, they will be automatically added to this product group."),(0,n.kt)("h2",{id:"api-setup"},"API setup"),(0,n.kt)("p",null,"The final step is to add and verify the required endpoints for the payment process.",(0,n.kt)("br",{parentName:"p"}),"\n","You will need two endpoints: a checkout endpoint and a cancellation endpoint. They will be used to process payments and cancel subscriptions, respectively."),(0,n.kt)("h3",{id:"endpoint-configuration"},"Endpoint configuration"),(0,n.kt)("admonition",{type:"caution"},(0,n.kt)("p",{parentName:"admonition"},"To use the payment functionality, you must use cookies or dynamic tokens as your API security settings.")),(0,n.kt)("p",null,"In Kuroco's left sidebar menu, click ","[API]"," and select the API where you will be adding the endpoint."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/e806f56c501dd75139ed612381965027.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/e806f56c501dd75139ed612381965027.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,"On the Endpoint List screen, click ","[Add New Endpoint]"," and add the following two endpoints"),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/060b0e609139f239dfa426948319ca16.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/060b0e609139f239dfa426948319ca16.png",alt:"Image from Gyazo"})),(0,n.kt)("h4",{id:"checkout-endpoint"},"Checkout endpoint"),(0,n.kt)("p",null,"Endpoint for generating payment URLs."),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Category"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Payments")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Model"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Stripe, v1")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Operation"),(0,n.kt)("td",{parentName:"tr",align:"left"},"checkout")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"products_list"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Enter the price ID (Stripe API ID) of the product.",(0,n.kt)("ul",null,(0,n.kt)("li",null,"Note: You can add multiple products to a single checkout."),(0,n.kt)("li",null,"Note: You can not change the price ID from the front end")))),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"return_url"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Front-end URL for the payment success page.")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"return_err_url"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Front-end URL for the payment failure page.")))),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/b9889847fd64019147e65b6bb0791239.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/b9889847fd64019147e65b6bb0791239.png",alt:"Image from Gyazo"}),"\n",(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/25f92f9d8bfed0326df740e76417288e.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/25f92f9d8bfed0326df740e76417288e.png",alt:"Image from Gyazo"})),(0,n.kt)("h4",{id:"cancellation-endpoint"},"Cancellation endpoint"),(0,n.kt)("p",null,"Endpoint for canceling subscriptions."),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Category"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Payments")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Model"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Stripe, v1")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Operation"),(0,n.kt)("td",{parentName:"tr",align:"left"},"cancel_order")))),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/3fdd41e0440c1d0966c59e02e6e751de.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/3fdd41e0440c1d0966c59e02e6e751de.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,"When you are done, click ","[Add]"," to save the endpoint."),(0,n.kt)("h3",{id:"verifying-the-billing-process"},"Verifying the billing process"),(0,n.kt)("p",null,"To check if your billing process is working as expected, verify the endpoint response from the Swagger UI and make a test payment."),(0,n.kt)("p",null,"From the sidebar menu, select the API containing your checkout endpoint. On the endpoint list screen, click ","[Swagger UI]","."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/6cfaa16ca4c22a3886b24ff5cebc3af7.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/6cfaa16ca4c22a3886b24ff5cebc3af7.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,"Log in as the member that you wish to make the test payment and click ","[Try it out]"," at the checkout endpoint."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/11f34df1503e6fded0c0b7d4005eab05.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/11f34df1503e6fded0c0b7d4005eab05.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,"Scroll down and click ","[Execute]","."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/a5fad6eb2f7f3f9997a1618335907b26.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/a5fad6eb2f7f3f9997a1618335907b26.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,"Copy the URL in the response body."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/5d8f120814340bb9459cb8d2e6d595f6.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/5d8f120814340bb9459cb8d2e6d595f6.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,"Access the URL in your browser. You should see the payment screen below. Enter your payment details and click ","[Subscribe]","."),(0,n.kt)("admonition",{type:"tip"},(0,n.kt)("p",{parentName:"admonition"},"You can use ",(0,n.kt)("a",{parentName:"p",href:"https://stripe.com/docs/testing#international-cards"},"test cards")," to simulate various scenarios.  ")),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/0933871454f537a755e9aa5939b9cb55.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/0933871454f537a755e9aa5939b9cb55.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,"If the payment was successful, you will be redirected to the payment success page you set in your endpoint.\nIf return_url is blank, the user will be redirected to the top page of the front-end URL."),(0,n.kt)("p",null,"Check the following three points to confirm that the operation has completed successfully."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"In the ID Information tab of the member information who made the payment, a group linked to Stripe is added to the group to which the member belongs.",(0,n.kt)("br",{parentName:"p"}),"\n",(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/72f433487a8b673517c1876e954224e9.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/72f433487a8b673517c1876e954224e9.png",alt:"Image from Gyazo"}))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},'Stripe Customer ID" and "Stripe Subscription ID" have been added in the Profile Information tab of the member information who made the payment.',(0,n.kt)("br",{parentName:"p"}),"\n",(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/e1a20cd5ab9e0b03e7d4c2bb3b49bd97.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/e1a20cd5ab9e0b03e7d4c2bb3b49bd97.png",alt:"Image from Gyazo"}))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"The member who made the payment is added in ","[Billing]","->","[Subscription]"," in the Stripe admin page, and the Stripe subscription ID matches the Kuroco admin page.",(0,n.kt)("br",{parentName:"p"}),"\n",(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/a4ab2faee0f781df82f33ac7c4a58ebe.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/a4ab2faee0f781df82f33ac7c4a58ebe.png",alt:"Image from Gyazo"}),(0,n.kt)("br",{parentName:"p"}),"\n",(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/144255e4f4b6d43e03646fd984099043.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/144255e4f4b6d43e03646fd984099043.png",alt:"Image from Gyazo"})))),(0,n.kt)("h3",{id:"verifying-the-subscription-cancellation"},"Verifying the subscription cancellation"),(0,n.kt)("p",null,"To test the cancellation process, log in as the member you wish to cancel the subscription with and click ","[Try it out]"," on the Cancel endpoint."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/9456bf51a59b865b258076a62a637a71.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/9456bf51a59b865b258076a62a637a71.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,"Scroll down and click ","[Execute]","."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/da498d949a34bcb60081542ded401a8c.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/da498d949a34bcb60081542ded401a8c.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,"The cancellation process is complete when the ok status is displayed.  "),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/fdbfac0405ee10a2b6e1d2c51128c1aa.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/fdbfac0405ee10a2b6e1d2c51128c1aa.png",alt:"Image from Gyazo"})),(0,n.kt)("p",null,"Check the following three points to confirm that the operation has completed successfully."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"In the ID Information tab of the member information that made the payment, the group linked to Stripe has been removed from the groups to which the member belongs.",(0,n.kt)("br",{parentName:"p"}),"\n",(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/c385a1675b1f77727fc342d484c7c762.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/c385a1675b1f77727fc342d484c7c762.png",alt:"Image from Gyazo"}))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},'The "Stripe Subscription ID" has been removed from the Profile Information tab of the member information that made the payment.',(0,n.kt)("br",{parentName:"p"}),"\n",(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/e1bc1c5dd837558321f574c6981cec09.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/e1bc1c5dd837558321f574c6981cec09.png",alt:"Image from Gyazo"}))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"The target member has been removed from the ","[Current]"," tab of ","[Billing]","->","[Subscription]"," in the Stripe administration screen and added to the ","[Canceled]"," tab.",(0,n.kt)("br",{parentName:"p"}),"\n",(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/2c1d15d69eb4d12eb6bf798be3c12954.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/2c1d15d69eb4d12eb6bf798be3c12954.png",alt:"Image from Gyazo"})))),(0,n.kt)("admonition",{type:"caution"},(0,n.kt)("p",{parentName:"admonition"},"Note that subscriptions are canceled immediately without redirecting to a confirmation page.\nAlso, no refunds will be given in the event of cancellation.")),(0,n.kt)("h2",{id:"more-information"},"More information"),(0,n.kt)("p",null,"Below are some points to take note of when setting up subscription billing with Stripe in Kuroco."),(0,n.kt)("h3",{id:"limitations"},"Limitations"),(0,n.kt)("p",null,"Currently, Kuroco does not support the following payment types with Stripe:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Guest checkout (i.e., non-logged-in users)"),(0,n.kt)("li",{parentName:"ul"},"One-time purchases"),(0,n.kt)("li",{parentName:"ul"},"Setting up multiple subscription IDs for one member")),(0,n.kt)("h3",{id:"stripe-cli"},"Stripe CLI"),(0,n.kt)("p",null,"You can also use the ",(0,n.kt)("a",{parentName:"p",href:"https://stripe.com/docs/stripe-cli"},"Stripe CLI")," developer tool to test your payment function by listening for real-time event changes such as new subscriptions, updates, and payment processing on your Stripe account."),(0,n.kt)("p",null,"To do this, run the command ",(0,n.kt)("inlineCode",{parentName:"p"},"stripe listen")," with the commonly used flags listed below. You will receive a webhook secret, which you can add to your local environment to decrypt the information."),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Flag"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"--forward-to"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Enter the your localhost URL to which you want to forward the webhook calls.")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"--events"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Enter a comma-separated list of events you want to listen for.",(0,n.kt)("ul",null,(0,n.kt)("li",null,"You can find the list of events on your ",(0,n.kt)("a",{parentName:"td",href:"#creating-your-webhook"},"Stripe webhook page"))))),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"--skip-verify"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Use this flag if you do not have a local SSL certificate or it is invalid.")))),(0,n.kt)("p",null,"For further details about using the Stripe CLI, see:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://stripe.com/docs/stripe-cli"},"Stripe Docs: Get started with the Stripe CLI")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://stripe.com/docs/stripe-cli/about-events"},"Stripe Docs: Listen for events with the Stripe CLI"))))}m.isMDXComponent=!0}}]);