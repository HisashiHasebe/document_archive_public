"use strict";(self.webpackChunkkurokuro=self.webpackChunkkurokuro||[]).push([[91331],{3905:(e,t,a)=>{a.d(t,{Zo:()=>s,kt:()=>u});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),c=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},s=function(e){var t=c(e.components);return n.createElement(p.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),d=c(a),h=r,u=d["".concat(p,".").concat(h)]||d[h]||m[h]||o;return a?n.createElement(u,i(i({ref:t},s),{},{components:a})):n.createElement(u,i({ref:t},s))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=h;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[d]="string"==typeof e?e:r,i[1]=l;for(var c=2;c<o;c++)i[c]=a[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},89268:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var n=a(87462),r=(a(67294),a(3905));const o={title:"Implementing a search function",category:"Front-end",weight:1},i=void 0,l={unversionedId:"tutorials/implement-a-search-function",id:"tutorials/implement-a-search-function",title:"Implementing a search function",description:"There are two ways to implement a search function in Kuroco:",source:"@site/docs/tutorials/implement-a-search-function.md",sourceDirName:"tutorials",slug:"/tutorials/implement-a-search-function",permalink:"/docs/tutorials/implement-a-search-function",draft:!1,editUrl:"https://github.com/diverta/kuroco-documents/tree/main/packages/create-docusaurus/templates/shared/docs/tutorials/implement-a-search-function.md",tags:[],version:"current",frontMatter:{title:"Implementing a search function",category:"Front-end",weight:1},sidebar:"documentationSidebar",previous:{title:"How to configure password reminder & reset",permalink:"/docs/tutorials/how-to-use-password-reminder"},next:{title:"Creating a custom function endpoint",permalink:"/docs/tutorials/creating-a-custom-function-endpoint"}},p={},c=[{value:"Implementing a search function using a filter",id:"implementing-a-search-function-using-a-filter",level:2},{value:"Before you start",id:"before-you-start",level:2},{value:"Create an API",id:"create-an-api",level:3},{value:"API",id:"api",level:4},{value:"CORS",id:"cors",level:4},{value:"Implementing a conditional search",id:"implementing-a-conditional-search",level:2},{value:"1. Create a content structure and an endpoint",id:"1-create-a-content-structure-and-an-endpoint",level:3},{value:"Content structure",id:"content-structure",level:4},{value:"Endpoint creation",id:"endpoint-creation",level:4},{value:"2. Configure the endpoint",id:"2-configure-the-endpoint",level:3},{value:"3. Verify the endpoint operations",id:"3-verify-the-endpoint-operations",level:3},{value:"Subject search",id:"subject-search",level:4},{value:"Selection type Search",id:"selection-type-search",level:4},{value:"4. Implement the search function",id:"4-implement-the-search-function",level:3},{value:"Implementing a keyword search",id:"implementing-a-keyword-search",level:2},{value:"1. Create a content structure and an endpoint",id:"1-create-a-content-structure-and-an-endpoint-1",level:3},{value:"Content structure",id:"content-structure-1",level:4},{value:"Endpoint",id:"endpoint",level:4},{value:"2. Configure the endpoint",id:"2-configure-the-endpoint-1",level:3},{value:"3. Verify the endpoint operations",id:"3-verify-the-endpoint-operations-1",level:3},{value:"4. Implement the search function",id:"4-implement-the-search-function-1",level:3},{value:"Appendix\uff1a Using a commercial service",id:"appendix-using-a-commercial-service",level:2}],s={toc:c},d="wrapper";function m(e){let{components:t,...a}=e;return(0,r.kt)(d,(0,n.Z)({},s,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"There are two ways to implement a search function in Kuroco:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Using a filter"),(0,r.kt)("li",{parentName:"ul"},"Using search providers such as Algolia and Syncsearch")),(0,r.kt)("p",null,"This tutorial explains how to implement a content search function using the first approach."),(0,r.kt)("h2",{id:"implementing-a-search-function-using-a-filter"},"Implementing a search function using a filter"),(0,r.kt)("p",null,"An API filter function allows you to implement a content search with conditions or keywords.  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/ddf5172d5095bd12d269c35c3bbc63f5.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/ddf5172d5095bd12d269c35c3bbc63f5.png",alt:"fetched from Gyazo"}),"\nFirst, let's review what a filter function does.    "),(0,r.kt)("p",null,"A filter function is used to filter data retrieved from an API endpoint. For example, entering the query below in the ",(0,r.kt)("inlineCode",{parentName:"p"},"filter")," parameter returns data that matches the specified condition:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"// specify contents with a topics_id of 1\ntopics_id = 1\n")),(0,r.kt)("p",null,"You can specify flexible conditions such as complete or partial matches, number and date comparisons, and ",(0,r.kt)("inlineCode",{parentName:"p"},"AND"),"/",(0,r.kt)("inlineCode",{parentName:"p"},"OR"),". This enables you to implement complex searches.  "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},'// Specify contents whose title includes "WORD" or that were added between 2021-01-01 and 2021-12-31\nsubject contains "WORD" OR (inst_ymdhi >= "2021-01-01" AND inst_ymdhi <= "2021-12-31")\n')),(0,r.kt)("p",null,"You can input the ",(0,r.kt)("inlineCode",{parentName:"p"},"filter")," parameter in the locations below based on what function it serves. "),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Location"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Endpoint settings"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Set fixed search conditions that are always applied.",(0,r.kt)("br",null)," For example, entering ",(0,r.kt)("inlineCode",{parentName:"td"},'inst_ymdhi >=: relatively "-1 year"')," here retrieves only contents added within a year from the current date and time.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"GET")," parameter"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Specify dynamic search conditions. ",(0,r.kt)("br",null)," If a filter has been set in the endpoint settings, the search results will match both conditions below:",(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"filter query(endpoint setting) AND filter query(GET parameter)"))))),(0,r.kt)("p",null,"To obtain variable results based on user input, set the ",(0,r.kt)("inlineCode",{parentName:"p"},"filter")," query with the ",(0,r.kt)("inlineCode",{parentName:"p"},"GET")," parameter.",(0,r.kt)("br",{parentName:"p"}),"\n","To add a fixed condition, enter the query in the endpoint settings as needed."),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"A filter can only be used when the API model supports the function. Look for the ",(0,r.kt)("inlineCode",{parentName:"p"},"filter")," parameter on the endpoint settings or Swagger UI screen.    ")),(0,r.kt)("p",null,"The next section explains how to implement a search function using a filter. This tutorial covers 2 types of searches:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Conditional search"),(0,r.kt)("li",{parentName:"ul"},"Keyword search")),(0,r.kt)("h2",{id:"before-you-start"},"Before you start"),(0,r.kt)("h3",{id:"create-an-api"},"Create an API"),(0,r.kt)("h4",{id:"api"},"API"),(0,r.kt)("p",null,"Set up a new API as follows. "),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Title"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"Filter function API"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Version"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"1.0"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"For use by filter function"))))),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/91b7894b01b12c4cf0ab8790e6499bb0.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/91b7894b01b12c4cf0ab8790e6499bb0.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Click ","[Add]"," to save these settings. You will be redirected to the Endpoint list screen. Click ","[Security]",".  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/7c5f15cb5f09cc2f81bd1352fdb5b4ad.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/7c5f15cb5f09cc2f81bd1352fdb5b4ad.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,'Select "Cookie" and click ',"[Save]","."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/af2084b7854d12769c1db588dc634d08.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/af2084b7854d12769c1db588dc634d08.png",alt:"Image from Gyazo"})),(0,r.kt)("h4",{id:"cors"},"CORS"),(0,r.kt)("p",null,"Next, click ","[Operation CORS]"," to configure the CORS settings."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/6363a55bc216235b148cc0f83aec9e7d.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/6363a55bc216235b148cc0f83aec9e7d.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,'Under "CORS_ALLOW_ORIGINS", add the following entries using ',"[Add Origin]","."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"http://localhost:3000")),(0,r.kt)("li",{parentName:"ul"},"(Your front-end domain name)")),(0,r.kt)("p",null,'Under "CORS_ALLOW_METHODS", add the following entries using ',"[Add Method]","."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"GET"),"  "),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"POST")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"OPTIONS"))),(0,r.kt)("p",null,'Under "CORS_ALLOW_CREDENTIALS", select "Allow Credentials".'),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/1d310e9bee67639d35fa5ee9ccbaf176.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/1d310e9bee67639d35fa5ee9ccbaf176.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Click ","[Save]"," when you are done."),(0,r.kt)("h2",{id:"implementing-a-conditional-search"},"Implementing a conditional search"),(0,r.kt)("p",null,"The steps below explain how to implement a conditional search based on the above overview.  "),(0,r.kt)("h3",{id:"1-create-a-content-structure-and-an-endpoint"},"1. Create a content structure and an endpoint"),(0,r.kt)("p",null,"Follow the steps below to create a content structure and an endpoint."),(0,r.kt)("h4",{id:"content-structure"},"Content structure"),(0,r.kt)("p",null,"In the left sidebar menu, select ","[Content structure]"," -> ","[Add]",".  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/c6a51330b6913619e9deb2bd90ca89ea.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/c6a51330b6913619e9deb2bd90ca89ea.png",alt:"Image (fetched from Gyazo)"}),"\nCreate a content structure with the following settings:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Group name\uff1a ",(0,r.kt)("inlineCode",{parentName:"li"},"Search")),(0,r.kt)("li",{parentName:"ul"},"Group ID\uff1a 7 (automatically assigned)")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/b6a506febd6d896e7ef1895e9c3a248e.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/b6a506febd6d896e7ef1895e9c3a248e.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Create the following additional fields."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"ID"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Field name"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Field settings"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Options"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"1"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"Text")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Single-line text"),(0,r.kt)("td",{parentName:"tr",align:"left"},"-")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"2"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"Select")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Dropdown selection"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"01::option1"),(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"02::option2"),(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"03::option3"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"3"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"Checkbox")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Multiple choice (checkbox)"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"01::option1"),(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"02::option2"),(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"03::option3"))))),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/dc3382fd27626ccf0562ca629fd7eb3f.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/dc3382fd27626ccf0562ca629fd7eb3f.png",alt:"Image from Gyazo"})),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"Please leave the ",(0,r.kt)("inlineCode",{parentName:"p"},"identifier")," fields blank.")),(0,r.kt)("p",null,"Add some test data to this content group as follows.  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/faa0ce0e00310c17c81f262377cef956.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/faa0ce0e00310c17c81f262377cef956.png",alt:"Image from Gyazo"})),(0,r.kt)("h4",{id:"endpoint-creation"},"Endpoint creation"),(0,r.kt)("p",null,"In the left sidebar menu, click ","[API]"," and select the filter function API to access its endpoint list screen.",(0,r.kt)("br",{parentName:"p"}),"\n","Click ","[Configure Endpoint]",".  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/7bd828bb50208f1b0dcaec4cd6140501.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/7bd828bb50208f1b0dcaec4cd6140501.png",alt:"fetched from Gyazo"}),"  "),(0,r.kt)("p",null,"Create an endpoint with the following settings:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Path"),(0,r.kt)("td",{parentName:"tr",align:"left"},"(/rcms-api/","*","*","/) ",(0,r.kt)("inlineCode",{parentName:"td"},"content"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Category"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Content")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Model"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Topics (v1)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Operation"),(0,r.kt)("td",{parentName:"tr",align:"left"},"list")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"topics_group_id"),(0,r.kt)("td",{parentName:"tr",align:"left"},'(ID of "Search" content group)')))),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/1752ed17083ec9654f6899ac6a4a7b14.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/1752ed17083ec9654f6899ac6a4a7b14.png",alt:"Image from Gyazo"}),"  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/d0ca0bfbaead805b566d886c75ab6d7f.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/d0ca0bfbaead805b566d886c75ab6d7f.png",alt:"Image from Gyazo"})),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"The content group ID can be found on the Content structure list screen.  ")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/b85e0adf286bce07230355163221c99c.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/b85e0adf286bce07230355163221c99c.png",alt:"Image from Gyazo"})),(0,r.kt)("h3",{id:"2-configure-the-endpoint"},"2. Configure the endpoint"),(0,r.kt)("p",null,"On the search endpoint list screen, click ","[Update]"," next to the endpoint you created.  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/f2ae266cf65dabe2ee94ab6ea9908c1c.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/f2ae266cf65dabe2ee94ab6ea9908c1c.png",alt:"fetched from Gyazo"}),"\nOn the pop-up screen, scroll down to the ",(0,r.kt)("inlineCode",{parentName:"p"},"filter_request_allow_list")," field.  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/6bf4d7a28bc3b557f301fe750269ee16.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/6bf4d7a28bc3b557f301fe750269ee16.png",alt:"Image (fetched from Gyazo)"}),"\nBy default, query filtering by the ",(0,r.kt)("inlineCode",{parentName:"p"},"GET")," parameter is disabled. Specifying the search items allowed using ",(0,r.kt)("inlineCode",{parentName:"p"},"filter_request_allow_list")," activates the filter.",(0,r.kt)("br",{parentName:"p"}),"\n","For this tutorial, add the following entries:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"subject")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"inst_ymdhi")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"ext_1")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"ext_2")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"ext_3"))),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Depending on when you signed up with Kuroco, additional fields may be follow the label format ",(0,r.kt)("inlineCode",{parentName:"p"},"ext_col_01")," instead of ",(0,r.kt)("inlineCode",{parentName:"p"},"ext_1"),".\nIf query filtering does not work using the above settings, please verify the Swagger UI response.")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/76b8701c59c2ac24232bf9acf6f1d453.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/76b8701c59c2ac24232bf9acf6f1d453.png",alt:"Image from Gyazo"})),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Entering ",(0,r.kt)("inlineCode",{parentName:"p"},":ALL")," here allows all fields to be searched. Although this is convenient, it sometimes weakens API security. (For example, fields that have not been set as valid response data will be also allowed as search items.)",(0,r.kt)("br",{parentName:"p"}),"\n","Therefore, we generally recommend setting each search item individually.",(0,r.kt)("br",{parentName:"p"}),"\n","If you use ",(0,r.kt)("inlineCode",{parentName:"p"},":ALL"),", check to ensure that there are no issues with the data returned by the endpoint.   ")),(0,r.kt)("p",null,"After you have specified the desired fields, click ","[Update]"," to save the changes."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/bc81d3bd2f1824014381eeb28178b24c.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/bc81d3bd2f1824014381eeb28178b24c.png",alt:"fetched from Gyazo"})),(0,r.kt)("h3",{id:"3-verify-the-endpoint-operations"},"3. Verify the endpoint operations"),(0,r.kt)("p",null,"On the API endpoint list screen, click ","[Swagger UI]",".  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/eae4cf23b3affe2dddee1e42fdd868f1.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/eae4cf23b3affe2dddee1e42fdd868f1.png",alt:"fetched from Gyazo"}),'\nUnder "Content" on the API Swagger UI screen, click the endpoint you have configured. This opens a dropdown panel.'),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/c23357e683cad8f88609513c16c54275.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/c23357e683cad8f88609513c16c54275.png",alt:"fetched from Gyazo"}),"\nClick ","[Try it out]"," to begin the verification.  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/3b7ce6dcfcbc19acb9fb78bddb55e63a.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/3b7ce6dcfcbc19acb9fb78bddb55e63a.png",alt:"fetched from Gyazo"})),(0,r.kt)("h4",{id:"subject-search"},"Subject search"),(0,r.kt)("p",null,"Enter a query in the ",(0,r.kt)("inlineCode",{parentName:"p"},"filter")," parameter. For this tutorial, enter ",(0,r.kt)("inlineCode",{parentName:"p"},'subject contains "Test"'),".  "),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"See: ",(0,r.kt)("a",{parentName:"p",href:"/docs/reference/filter-query/"},"How to use search function")," for more details on the query format.")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/b5ce5a4291a4e114c216471563c92ede.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/b5ce5a4291a4e114c216471563c92ede.png",alt:"fetched from Gyazo"}),"\nAfter you have entered your query, scroll down to the bottom and click ","[Execute]","."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/f7cc82bda94075b575482267bb9a1dfe.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/f7cc82bda94075b575482267bb9a1dfe.png",alt:"fetched from Gyazo"}),"\nVerify the responses displayed. "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/6e16e823514a62681e620b76deb0b9d9.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/6e16e823514a62681e620b76deb0b9d9.png",alt:"fetched from Gyazo"})),(0,r.kt)("h4",{id:"selection-type-search"},"Selection type Search"),(0,r.kt)("p",null,'Enter "',(0,r.kt)("inlineCode",{parentName:"p"},'ext_2 = "01"'),'" and confirm that you can retrieve the content for the selected option1.'),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/e1ef5dfd0e6cc533b8033fc96a01ccb9.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/e1ef5dfd0e6cc533b8033fc96a01ccb9.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Once input is complete, click the ","[Execute]"," button."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/f7cc82bda94075b575482267bb9a1dfe.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/f7cc82bda94075b575482267bb9a1dfe.png",alt:"Image (fetched from Gyazo)"})),(0,r.kt)("p",null,"Check if the results are displayed as expected, confirming whether the search is performed correctly."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/8bca6c48782efda20aed97b6062dd60c.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/8bca6c48782efda20aed97b6062dd60c.png",alt:"Image from Gyazo"})),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"The key for the selection type content is stored as a string.\nWhen applying filters, make sure to enclose them explicitly with ",(0,r.kt)("inlineCode",{parentName:"p"},'" "'),"."),(0,r.kt)("p",{parentName:"admonition"},"For example, even if the selection type are registered as follows, apply the filter as ",(0,r.kt)("inlineCode",{parentName:"p"},'ext_2 = "1"')," instead of ",(0,r.kt)("inlineCode",{parentName:"p"},"ext_2 = 1"),"."),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre"},"1::option1\n2::option2\n3::option3\n"))),(0,r.kt)("h3",{id:"4-implement-the-search-function"},"4. Implement the search function"),(0,r.kt)("p",null,"Next, implement a search function using the configured endpoint.  "),(0,r.kt)("p",null,"For this tutorial, we use Nuxt.js to create a simple search form and search results table.  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/9e21a0df231bb6cd0f9fa2ea756f24a4.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/9e21a0df231bb6cd0f9fa2ea756f24a4.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"First, create the following component under the file name ",(0,r.kt)("inlineCode",{parentName:"p"},"pages/search/index.vue"),".  "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-markup"},'<template>\n  <div>\n    <div class="search-form">\n      <p>\n        <label for="subject">Title</label>\n        <input v-model="searchInput.subject" type="text">\n      </p>\n      <p>\n        <label for="inst_ymdhi">Created at</label>\n        <input v-model="searchInput.inst_ymdhi.from" type="date"> \n        ~\n        <input v-model="searchInput.inst_ymdhi.to" type="date"> \n      </p>\n      <p>\n        <label for="ext_1">Text</label>\n        <input v-model="searchInput.ext_1" type="text">\n      </p>\n      <p>\n        <label for="ext_2">Select</label>\n        <select v-model="searchInput.ext_2">\n          <option value="">Not selected</option>\n          <option value="01">option1</option>\n          <option value="02">option2</option>\n          <option value="03">option3</option>\n        </select>\n      </p>\n      <p>\n        <label for="ext_3">Checkbox</label>\n        <input v-model="searchInput.ext_3" type="checkbox" value="01">option1\n        <input v-model="searchInput.ext_3" type="checkbox" value="02">option2\n        <input v-model="searchInput.ext_3" type="checkbox" value="03">option3\n      </p>  \n      <button type="button">Search</button>\n    </div>\n    <div v-if="Object.keys(searchResult).length > 0" class="search-result">\n      <template v-if="(searchResult.errors || []).length === 0">\n        <table>\n          <tr>\n            <th>ID</th>\n            <th>Title</th>\n            <th>Created at</th>\n            <th>Text</th>\n            <th>Select</th>\n            <th>Checkbox</th>\n          </tr>\n          <tr v-for="content in searchResult.list" :key="content.topics_id">\n            <td>{{ content.topics_id }}</td>\n            <td>{{ content.subject }}</td>\n            <td>{{ content.inst_ymdhi }}</td>\n            <td>{{ content.ext_1 }}</td>\n            <td>{{ content.ext_2 }}</td>\n            <td>{{ content.ext_3 }}</td>\n          </tr>\n        </table>\n      </template>\n      <template v-else>\n        {{ searchResult.errors }}\n      </template>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      searchInput: {\n        subject: \'\',\n        inst_ymdhi: {\n          from: \'\',\n          to: \'\',\n        },\n        ext_1: \'\',\n        ext_2: \'\',\n        ext_3: []\n      },\n      searchResult: {},\n    }\n  },\n  mounted() {},\n  methods: {}\n}\n<\/script>\n\n<style scoped>\n.search-form {\n  border: 1px solid;\n  padding: 10px;\n}\n.search-form label {\n  display: block;\n  float: left;\n  width: 100px;\n}\n.search-result {\n  width: 100%;\n  margin-top: 20px;\n}\n.search-result table, th, td {\n  border: solid 1px;\n  border-collapse: collapse;\n}\n.search-result th, td {\n  padding: 5px;\n}\n.search-result table {\n  width: 100%;\n}\n</style>\n')),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},".search-form")," element displays a search form, and ",(0,r.kt)("inlineCode",{parentName:"p"},".search-result")," shows a search result."),(0,r.kt)("p",null,"Any user-entered values are stored in ",(0,r.kt)("inlineCode",{parentName:"p"},"searchInput")," within the ",(0,r.kt)("inlineCode",{parentName:"p"},"data")," object. The corresponding search result responses are stored in ",(0,r.kt)("inlineCode",{parentName:"p"},"searchResult"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"data() {\n  return {\n    // User input values (.search-form)\n    searchInput: {\n      subject: '',\n      inst_ymdhi: {\n        from: '',\n        to: '',\n      },\n      ext_1: '',\n      ext_2: '',\n      ext_3: []\n    },\n    // Search result responses (.search-result)\n    searchResult: {},\n  }\n},\n")),(0,r.kt)("p",null,"Run the command ",(0,r.kt)("inlineCode",{parentName:"p"},"npm run dev")," to launch your local environment and go to http://localhost:3000/search. You should see the form below."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/0f8ebd947b86f08bab18625adf00598f.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/0f8ebd947b86f08bab18625adf00598f.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"At this stage, nothing happens if you click the ","[Search]"," button, because you haven't implemented the endpoint call process yet. To do so, you must define ",(0,r.kt)("inlineCode",{parentName:"p"},"methods")," and implement a search process by calling an endpoint.",(0,r.kt)("br",{parentName:"p"}),"\n","First, create a ",(0,r.kt)("inlineCode",{parentName:"p"},"search"),' method. Write your process to call the endpoint you configured above and name it "2. Endpoint settings".  '),(0,r.kt)("p",null,"This method transfers the filter query generation process to the ",(0,r.kt)("inlineCode",{parentName:"p"},"buildFilterQuery")," method. (The detailed mechanisms will be explained later.)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"methods: {\n  // Send request to the endpoint and store the fetch result in 'searchResult'.\n  async search() {\n    let searchResult;\n    try {\n      // Replace the endpoint URL below with your own.\n      const response = await this.$axios.get(\"/rcms-api/3/content\", {\n        params: {\n          filter: this.buildFilterQuery()\n        }\n      })\n      searchResult = response?.data || {};\n    } catch(errorResponse) {\n      searchResult = { errors: errorResponse?.data?.errors || ['Unexpected error'] };\n    }\n    this.searchResult = searchResult;\n  },\n  // Generate filter query\n  buildFilterQuery() {\n    return '';\n  }\n}\n")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Substitute ",(0,r.kt)("inlineCode",{parentName:"p"},"/rcms-api/3/content")," above with the path shown in your own Kuroco admin panel.")),(0,r.kt)("p",null,"Second, define the ",(0,r.kt)("inlineCode",{parentName:"p"},"search")," method as a click event of the ","[Search]"," button, located at the bottom of the ",(0,r.kt)("inlineCode",{parentName:"p"},".search-form")," element.  "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!--\n    <button type="button">Search</button> <= add \'@click="search"\'\n--\x3e\n<button type="button" @click="search">Search</button>\n')),(0,r.kt)("p",null,"Third, write the specific process of ",(0,r.kt)("inlineCode",{parentName:"p"},"buildFilterQuery"),". It converts the value stored in the ",(0,r.kt)("inlineCode",{parentName:"p"},"searchInput")," data attribute to a filter query.  "),(0,r.kt)("p",null,"For this tutorial, we generate a query with the following conditions:  "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Date: Specify range"),(0,r.kt)("li",{parentName:"ul"},"Text: Partial match"),(0,r.kt)("li",{parentName:"ul"},"Select: Full match"),(0,r.kt)("li",{parentName:"ul"},"Checkbox: Partial match")),(0,r.kt)("p",null,"Fields with no input value are not included in the search conditions."),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"The generated query varies depending on the input format, target field, and functional requirements. Please implement the appropriate process based on your own environment.  ")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"methods: {\n  // ...\n  buildFilterQuery() {\n    const filterQuery = Object.entries(this.searchInput).reduce((queries, [col, value]) => {\n      switch (col) {\n        // Date: Select range\n        case 'inst_ymdhi':\n          if (value.from !== '') {\n            queries.push(`${col} >= \"${value.from}\"`);\n          }\n          if (value.to !== '') {\n            queries.push(`${col} <= \"${value.to}\"`);\n          }\n          break;\n        // Text: Partial match\n        case 'subject':\n        case 'ext_1':\n          if (value !== '') {\n            queries.push(`${col} contains \"${value}\"`);\n          }\n          break;\n        // Select: Full match\n        case 'ext_2':\n          if (value !== '') {\n            queries.push(`${col} = \"${value}\"`);\n          }\n          break;\n        // Checkbox : Partial match\n        case 'ext_3':\n          if (value.length > 0) {\n            queries.push('(' + value.map(v => `${col} contains \"${v}\"`).join(' OR ') + ')');\n          }\n          break;\n        default:\n          break;\n      }\n      return queries;\n    }, []).join(' AND ');\n\n    return filterQuery;\n  }\n}\n")),(0,r.kt)("p",null,"Lastly, add the following code to ",(0,r.kt)("inlineCode",{parentName:"p"},"mounted")," to display the contents list without condition specifications by default.  "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"mounted() {\n  this.search();\n},\n")),(0,r.kt)("p",null,"Now you have implemented the conditional search component. Test the form on your localhost to verify the results."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/cb53be46bed20019b50faaff9d54bdb4.gif?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/cb53be46bed20019b50faaff9d54bdb4.gif",alt:"Image from Gyazo"})),(0,r.kt)("h2",{id:"implementing-a-keyword-search"},"Implementing a keyword search"),(0,r.kt)("p",null,"This section explains how to implement a keyword search function.  "),(0,r.kt)("p",null,"Based on the above conditional search implementation, you might have thought of connecting partial match conditions for each item with ",(0,r.kt)("inlineCode",{parentName:"p"},"OR"),".  "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},'subject contains "KEYWORD" OR ext_1 contains "KEYWORD"\n')),(0,r.kt)("p",null,"You can create a keyword search function simply using this approach. However, as the number of items increases, issues can arise when you pass long, complex queries like this one:  "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},'subject contains "KEYWORD" OR ext_1 contains "KEYWORD" OR ext_4 contains "KEYWORD" OR ext_5 contains "KEYWORD" OR ext_6 contains "KEYWORD" OR ...\n')),(0,r.kt)("p",null,"Therefore, the filter function contains the following mechanism to implement simpler keyword search queries:  "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},'search_keyword contains "KEYWORD"\n')),(0,r.kt)("p",null,"The steps below show you how to implement the ",(0,r.kt)("inlineCode",{parentName:"p"},"search_keyword")," function. "),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Some sites work with ",(0,r.kt)("inlineCode",{parentName:"p"},"keyword")," instead of ",(0,r.kt)("inlineCode",{parentName:"p"},"search_keyword")," depending on when you applied for Kuroco.",(0,r.kt)("br",{parentName:"p"}),"\n","If it does not work well, please try using ",(0,r.kt)("inlineCode",{parentName:"p"},"keyword")," as well.")),(0,r.kt)("h3",{id:"1-create-a-content-structure-and-an-endpoint-1"},"1. Create a content structure and an endpoint"),(0,r.kt)("p",null,"For this tutorial, use the following content structure and endpoint:"),(0,r.kt)("h4",{id:"content-structure-1"},"Content structure"),(0,r.kt)("p",null,"Use the ",(0,r.kt)("a",{parentName:"p",href:"#implementing-a-conditional-search"},"conditional search")," you implemented above."),(0,r.kt)("h4",{id:"endpoint"},"Endpoint"),(0,r.kt)("p",null,"Create an endpoint with the following settings:  "),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Field"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Path"),(0,r.kt)("td",{parentName:"tr",align:"left"},"(/rcms-api/","*","*","/)",(0,r.kt)("inlineCode",{parentName:"td"},"content_keyword"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Category"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Content")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Model"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Topics (v1)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Operation"),(0,r.kt)("td",{parentName:"tr",align:"left"},"list")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"topics_group_id"),(0,r.kt)("td",{parentName:"tr",align:"left"},'(ID of the "Search" content group)')))),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/37a8c453cf143596eab2e4ec1c201b6c.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/37a8c453cf143596eab2e4ec1c201b6c.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/7bce3d03af808a1bdd358796869e3fe6.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/7bce3d03af808a1bdd358796869e3fe6.png",alt:"Image from Gyazo"})),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"The content group ID can be found on the Content structure list screen. ")),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/b85e0adf286bce07230355163221c99c.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/b85e0adf286bce07230355163221c99c.png",alt:"Image from Gyazo"})),(0,r.kt)("h3",{id:"2-configure-the-endpoint-1"},"2. Configure the endpoint"),(0,r.kt)("p",null,"On the search endpoint list page, select the endpoint you want to implement the search function for and click ","[Update]",".  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/9a03c4790296a20cc19aba0890366da6.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/9a03c4790296a20cc19aba0890366da6.png",alt:"fetched from Gyazo"}),"  "),(0,r.kt)("p",null,"On the pop-up screen, scroll down to the ",(0,r.kt)("inlineCode",{parentName:"p"},"filter_request_allow_list")," field.  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/5c49754a2ce4e94e1f87f91510250564.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/5c49754a2ce4e94e1f87f91510250564.png",alt:"fetched from Gyazo"}),"  "),(0,r.kt)("p",null,"The allowed search items follow the formats below:  "),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Format"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"search_keyword"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Searches for all items (e.g., ",(0,r.kt)("inlineCode",{parentName:"td"},"search_keyword"),").")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"search_keyword:","[item 1,item 2,...]"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Enter multiple search items separated with a comma (e.g., ",(0,r.kt)("inlineCode",{parentName:"td"},"search_keyword:[subject]"),"; ",(0,r.kt)("inlineCode",{parentName:"td"},"search_keyword:[ext_1,ext_2]"),").")))),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"The value ",(0,r.kt)("inlineCode",{parentName:"p"},":ALL")," includes ",(0,r.kt)("inlineCode",{parentName:"p"},"search_keyword")," as a search item along with the other items specified.  ")),(0,r.kt)("p",null,"For this tutorial, enter ",(0,r.kt)("inlineCode",{parentName:"p"},"search_keyword:[subject,ext_1]")," to set the title and text as the search items."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/b376af6e74db697684ed8bbd7e0605c6.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/b376af6e74db697684ed8bbd7e0605c6.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Click ","[Update]"," to save the settings."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/b9bdfb7a9196784107c8d234ee6dae9d.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/b9bdfb7a9196784107c8d234ee6dae9d.png",alt:"fetched from Gyazo"})),(0,r.kt)("h3",{id:"3-verify-the-endpoint-operations-1"},"3. Verify the endpoint operations"),(0,r.kt)("p",null,"On the API endpoint list screen, click ","[Swagger UI]",".  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/fd8468f04c8883552775493bdcc59970.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/fd8468f04c8883552775493bdcc59970.png",alt:"Image from Gyazo"}),"\nOn the Swagger UI screen, click the endpoint you created.  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/7060e39b980b4d20289e831b6b611e3f.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/7060e39b980b4d20289e831b6b611e3f.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Click ","[Try it out]"," to begin the verification."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/39f8ff27c523eec658e3841cf49d5e0e.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/39f8ff27c523eec658e3841cf49d5e0e.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"For this tutorial, we want to generate a search query with a partial match using the ",(0,r.kt)("inlineCode",{parentName:"p"},"contains")," command.",(0,r.kt)("br",{parentName:"p"}),"\n","Enter ",(0,r.kt)("inlineCode",{parentName:"p"},'search_keyword contains "1"')," in the ",(0,r.kt)("inlineCode",{parentName:"p"},"filter")," parameter."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/0b4c3847beaf1949070244ed799f3b49.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/0b4c3847beaf1949070244ed799f3b49.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Click ","[Execute]","."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/f7cc82bda94075b575482267bb9a1dfe.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/f7cc82bda94075b575482267bb9a1dfe.png",alt:"fetched from Gyazo"}),"\nVerify the responses displayed.  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/6e16e823514a62681e620b76deb0b9d9.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/6e16e823514a62681e620b76deb0b9d9.png",alt:"fetched from Gyazo"})),(0,r.kt)("h3",{id:"4-implement-the-search-function-1"},"4. Implement the search function"),(0,r.kt)("p",null,"Next, implement the search function using the endpoint you set up earlier.  "),(0,r.kt)("p",null,"For this tutorial, we use Nuxt.js to create the components for a simple search form and search result table.  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/cd23b4d4ed6128babe353d097c010d5d.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/cd23b4d4ed6128babe353d097c010d5d.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"First, create the following component under the file name ",(0,r.kt)("inlineCode",{parentName:"p"},"pages/search_keyword/index.vue"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-markup"},'<template>\n  <div>\n    <div class="search-form">\n      <p>\n        <label for="keyword">Keyword</label>\n        <input v-model="searchInput.search_keyword" type="text">\n      </p>\n      <button type="button" @click="search">Search</button>\n    </div>\n    <div v-if="Object.keys(searchResult).length > 0" class="search-result">\n      <template v-if="(searchResult.errors || []).length === 0">\n        <table>\n          <tr>\n            <th>ID</th>\n            <th>Title</th>\n            <th>Created at</th>\n            <th>Text</th>\n            <th>Select</th>\n            <th>Checkbox</th>\n          </tr>\n          <tr v-for="content in searchResult.list" :key="content.topics_id">\n            <td>{{ content.topics_id }}</td>\n            <td>{{ content.subject }}</td>\n            <td>{{ content.inst_ymdhi }}</td>\n            <td>{{ content.ext_1 }}</td>\n            <td>{{ content.ext_2 }}</td>\n            <td>{{ content.ext_3 }}</td>\n          </tr>\n        </table>\n      </template>\n      <template v-else>\n        {{ searchResult.errors }}\n      </template>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      searchInput: {\n        search_keyword: \'\',\n      },\n      searchResult: {},\n    }\n  },\n  mounted() {\n    this.search();\n  },\n  methods: {\n  async search() {\n      let searchResult;\n      try {\n        // Replace with your own endpoint URL.\n        const response = await this.$axios.get("/rcms-api/3/content_keyword", {\n          params: {\n            filter: this.buildFilterQuery()\n          }\n        })\n        searchResult = response?.data || {};\n      } catch(errorResponse) {\n        searchResult = { errors: errorResponse?.data?.errors || [\'Unexpected error\'] };\n      }\n      this.searchResult = searchResult;\n    },\n    // Generate filter query.\n    buildFilterQuery() {\n      return \'\';\n    }\n  }\n}\n<\/script>\n\n<style scoped>\n.search-form {\n  border: 1px solid;\n  padding: 10px;\n}\n.search-form label {\n  display: block;\n  float: left;\n  width: 100px;\n}\n.search-result {\n  width: 100%;\n  margin-top: 20px;\n}\n.search-result table, th, td {\n  border: solid 1px;\n  border-collapse: collapse;\n}\n.search-result th, td {\n  padding: 5px;\n}\n.search-result table {\n  width: 100%;\n}\n</style>\n')),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Substitute ",(0,r.kt)("inlineCode",{parentName:"p"},"/rcms-api/3/content_keyword")," above with the path shown in your own Kuroco admin panel.")),(0,r.kt)("p",null,"Run the ",(0,r.kt)("inlineCode",{parentName:"p"},"npm run dev")," command to launch your local environment and go to http://localhost:3000/search_keyword. You should see the form below."),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/cd23b4d4ed6128babe353d097c010d5d.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/cd23b4d4ed6128babe353d097c010d5d.png",alt:"Image from Gyazo"})),(0,r.kt)("p",null,"Use the same attribute definitions as the conditional search above, except for the following:  "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},".search-form")," element in the template"),(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"searchInput"),"property of the ",(0,r.kt)("inlineCode",{parentName:"li"},"data")," object"),(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"buildFilterQuery")," method")),(0,r.kt)("p",null,"For the ",(0,r.kt)("inlineCode",{parentName:"p"},".search-form")," element, define only the keyword input field. Store the entered value in ",(0,r.kt)("inlineCode",{parentName:"p"},"searchInput.search_keyword"),".  "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'<div class="search-form">\n    <p>\n    <label for="keyword">Keyword</label>\n    <input v-model="searchInput.keyword" type="text">\n    </p>\n    <button type="button" @click="search">Search</button>\n</div>\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"data() {\n  return {\n    searchInput: {\n      search_keyword: '',\n    },\n    searchResult: {},\n  }\n},\n")),(0,r.kt)("p",null,"As the final step of implementing the keyword search function, edit ",(0,r.kt)("inlineCode",{parentName:"p"},"buildFilterQuery")," to include the keyword search query generation process.  "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"methods: {\n  // ...\n  buildFilterQuery() {\n    const filterQuery = Object.entries(this.searchInput).reduce((queries, [col, value]) => {\n      switch (col) {\n        case 'search_keyword':\n          if (value !== '') {\n            queries.push(`${col} contains \"${value}\"`);\n          }\n          break;\n        default:\n          break;\n      }\n      return queries;\n    }, []).join(' AND ');\n    return filterQuery;\n  }\n}\n")),(0,r.kt)("p",null,"Now you are ready to test the form on your localhost and verify the results.  "),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/4c4a9b35e74c8efc61c7f5b4ceee2273.gif?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/4c4a9b35e74c8efc61c7f5b4ceee2273.gif",alt:"Image from Gyazo"})),(0,r.kt)("h2",{id:"appendix-using-a-commercial-service"},"Appendix\uff1a Using a commercial service"),(0,r.kt)("p",null,"In this tutorial, we will not go into specific details, but if you need to search through tens of thousands of records or require fast retrieval of large amounts of data, there is also an option to use external services. There are no particular usage restrictions, so please consider the following as a reference as well."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.algolia.com/"},"Algolia")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://programmablesearchengine.google.com/about/"},"Programmable Search Engine(Google)")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.syncsearch.jp/"},"Syncsearch")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.marsflag.com/en/"},"Marsflag"))))}m.isMDXComponent=!0}}]);