"use strict";(self.webpackChunkkurokuro=self.webpackChunkkurokuro||[]).push([[65078],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>u});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=r.createContext({}),m=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},d=function(e){var t=m(e.components);return r.createElement(s.Provider,{value:t},e.children)},c="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,i=e.originalType,s=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),c=m(a),h=n,u=c["".concat(s,".").concat(h)]||c[h]||p[h]||i;return a?r.createElement(u,l(l({ref:t},d),{},{components:a})):r.createElement(u,l({ref:t},d))}));function u(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=a.length,l=new Array(i);l[0]=h;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[c]="string"==typeof e?e:n,l[1]=o;for(var m=2;m<i;m++)l[m]=a[m];return r.createElement.apply(null,l)}return r.createElement.apply(null,a)}h.displayName="MDXCreateElement"},10665:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>m});var r=a(87462),n=(a(67294),a(3905));const i={title:"Prepare a keyword search string",description:"In addition to the content items, it is possible to prepare a string that will be the target of keyword searches. This time, we will set it so that the profiles of members associated with the content will be the search target."},l=void 0,o={unversionedId:"tutorials/how-to-implement-cutom-body-search",id:"tutorials/how-to-implement-cutom-body-search",title:"Prepare a keyword search string",description:"In addition to the content items, it is possible to prepare a string that will be the target of keyword searches. This time, we will set it so that the profiles of members associated with the content will be the search target.",source:"@site/docs/tutorials/how-to-implement-cutom-body-search.md",sourceDirName:"tutorials",slug:"/tutorials/how-to-implement-cutom-body-search",permalink:"/docs/tutorials/how-to-implement-cutom-body-search",draft:!1,editUrl:"https://github.com/diverta/kuroco-documents/tree/main/packages/create-docusaurus/templates/shared/docs/tutorials/how-to-implement-cutom-body-search.md",tags:[],version:"current",frontMatter:{title:"Prepare a keyword search string",description:"In addition to the content items, it is possible to prepare a string that will be the target of keyword searches. This time, we will set it so that the profiles of members associated with the content will be the search target."},sidebar:"documentationSidebar",previous:{title:"Setting up an API field to input current weather using OpenWeatherMap",permalink:"/docs/tutorials/setting-up-api-field-for-current-weather-input-with-openweathermap"},next:{title:"How to correctly use KurocoFiles and KurocoFront to manages images & files",permalink:"/docs/tutorials/difference-between-kurocofiles-and-kurocofront"}},s={},m=[{value:"Overview",id:"overview",level:2},{value:"What you can learn",id:"what-you-can-learn",level:3},{value:"Prepare the content",id:"prepare-the-content",level:2},{value:"Create a content structure",id:"create-a-content-structure",level:3},{value:"Configure member extended items",id:"configure-member-extended-items",level:3},{value:"Set the target string for search",id:"set-the-target-string-for-search",level:2},{value:"Check the search target string template",id:"check-the-search-target-string-template",level:3},{value:"Reference",id:"reference",level:4},{value:"Modifying the Search Target String Template",id:"modifying-the-search-target-string-template",level:3},{value:"Saving the Search Target String Template",id:"saving-the-search-target-string-template",level:3},{value:"Confirming the Operation",id:"confirming-the-operation",level:2},{value:"Adding Content",id:"adding-content",level:3},{value:"Checking the Search Target String",id:"checking-the-search-target-string",level:3},{value:"Prepare the Full-Text Search Endpoint",id:"prepare-the-full-text-search-endpoint",level:3},{value:"Check with Swagger UI",id:"check-with-swagger-ui",level:3},{value:"Related Documents",id:"related-documents",level:2}],d={toc:m},c="wrapper";function p(e){let{components:t,...a}=e;return(0,n.kt)(c,(0,r.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"overview"},"Overview"),(0,n.kt)("p",null,"In addition to the content items, you can prepare a string for full-text searches.",(0,n.kt)("br",{parentName:"p"}),"\n","The string for full-text searches can be set using Smarty in the keyword template of the content structure, so you can add or delete strings to be used for searches from the registered content, and add other content or member information associated with the content as strings for searches.",(0,n.kt)("br",{parentName:"p"}),"\n","In addition, by using only this template for keyword searches, the performance of the search will be improved."),(0,n.kt)("p",null,"This time, we will set it so that the profiles of members associated with the content will be the search target, focusing on the schedule of a lecture."),(0,n.kt)("h3",{id:"what-you-can-learn"},"What you can learn"),(0,n.kt)("p",null,"We will configure and verify the keyword template using the following steps.  "),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#prepare-the-content"},"Prepare the content")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#set-the-target-string-for-search"},"Set the target string for search")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#confirming-the-operation"},"Confirming the Operation"))),(0,n.kt)("h2",{id:"prepare-the-content"},"Prepare the content"),(0,n.kt)("p",null,"Set the necessary items for the content and members."),(0,n.kt)("h3",{id:"create-a-content-structure"},"Create a content structure"),(0,n.kt)("p",null,"Refer to ",(0,n.kt)("a",{parentName:"p",href:"/docs/tutorials/adding-a-topics/"},"Creating Content structure")," to create a content structure that will be the target of full-text searches.",(0,n.kt)("br",{parentName:"p"}),"\n","This time, assuming the schedule of a lecture, we created the following content structure."),(0,n.kt)("p",null,"Basic items"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Item Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Content"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Name"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Lecture")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Method of entering the main text"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Text area")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Use template for keyword search"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Check ","[Enable]")))),(0,n.kt)("p",null,"Fields"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"ID"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Field Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Identifier"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Field  Settings"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Item Setting Options"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"01"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Presenter"),(0,n.kt)("td",{parentName:"tr",align:"left"},"presenter"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Select related information"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Module: Member")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"02"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Date and Time"),(0,n.kt)("td",{parentName:"tr",align:"left"},"date"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Date format"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Also set the time (hh:mm)")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"03"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Theme"),(0,n.kt)("td",{parentName:"tr",align:"left"},"theme"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Text"),(0,n.kt)("td",{parentName:"tr",align:"left"})),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"04"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Online Streaming"),(0,n.kt)("td",{parentName:"tr",align:"left"},"streaming"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Selection format"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Required input",(0,n.kt)("br",null),"Use radio buttons",(0,n.kt)("br",null),"0: No online streaming",(0,n.kt)("br",null),"1: Online streaming available")))),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/600483302570d97b50c50ccf9f3a0418.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/600483302570d97b50c50ccf9f3a0418.png",alt:"Image from Gyazo"})),(0,n.kt)("h3",{id:"configure-member-extended-items"},"Configure member extended items"),(0,n.kt)("p",null,"Refer to ",(0,n.kt)("a",{parentName:"p",href:"/docs/management/extra-information/"},"Extended item settings")," and ",(0,n.kt)("a",{parentName:"p",href:"/docs/reference/list-of-extra-column-available-on-member-field-settings/"},"List of extension items in member detailed settings.")," to configure the items.\nThis time, assuming the presenter of the lecture, we added the following extended item."),(0,n.kt)("p",null,"Fields"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Item Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Identifier"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Settings"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"Public Profile"),(0,n.kt)("td",{parentName:"tr",align:"left"},"publish_profile"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Text area")))),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/c001e66f8de8c3079cd64e41899cf5cd.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/c001e66f8de8c3079cd64e41899cf5cd.png",alt:"Image from Gyazo"})),(0,n.kt)("h2",{id:"set-the-target-string-for-search"},"Set the target string for search"),(0,n.kt)("h3",{id:"check-the-search-target-string-template"},"Check the search target string template"),(0,n.kt)("p",null,"By default, the following are entered as templates that will be the search targets:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"topics_id"),(0,n.kt)("li",{parentName:"ul"},"slug"),(0,n.kt)("li",{parentName:"ul"},"Title"),(0,n.kt)("li",{parentName:"ul"},"Content"),(0,n.kt)("li",{parentName:"ul"},"Category"),(0,n.kt)("li",{parentName:"ul"},"Text part of all extended items.")),(0,n.kt)("admonition",{type:"info"},(0,n.kt)("p",{parentName:"admonition"},"If you want to return to the initial state, update it with an empty value and the default template will be automatically entered.")),(0,n.kt)("h4",{id:"reference"},"Reference"),(0,n.kt)("p",null,"The available variables are as follows."),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:"left"},"Variable Name"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Type"),(0,n.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"$details"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Object"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Content details")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:"left"},"$ext_config"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Object"),(0,n.kt)("td",{parentName:"tr",align:"left"},"Content extension settings")))),(0,n.kt)("p",null,"The text output by Smarty's description will be the target of full-text search."),(0,n.kt)("h3",{id:"modifying-the-search-target-string-template"},"Modifying the Search Target String Template"),(0,n.kt)("p",null,'Modify the template of the content structure added in "',(0,n.kt)("a",{parentName:"p",href:"#create-a-content-structure"},"Create a content structure"),'". In this example, the following items are added to the search target string:'),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Title"),(0,n.kt)("li",{parentName:"ul"},"Name and public profile of member information associated with related information"),(0,n.kt)("li",{parentName:"ul"},"Formatted date and time of the event"),(0,n.kt)("li",{parentName:"ul"},"Theme"),(0,n.kt)("li",{parentName:"ul"},"Label for online streaming")),(0,n.kt)("p",null,'For information on retrieving member information associated with related information, refer to "',(0,n.kt)("a",{parentName:"p",href:"/docs/faq/how-to-request-kuroco-api-from-smarty-function/"},"CCan I call Kuroco's API from custom function?"),'".'),(0,n.kt)("p",null,"Delete all default settings and write as follows:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-Smarty"},'{* Title *}\n{$details.subject|escape}\n\n{* Presenter *}\n{if $details.presenter.module_type eq \'member\' && $details.presenter.module_id}\n    {capture name=method_params}{ldelim}\n        "filter": "member_id eq {$details.presenter.module_id}"\n    {rdelim}{/capture}\n    {assign var=method_params value=$smarty.capture.method_params|json_decode:1}\n    {api_method\n        var=member_list\n        model="Member"\n        method="list"\n        version="1"\n        method_params=$method_params\n    }\n    {foreach from=$member_list.list item=member}\n        {* Name *}\n        {$member.name1|escape} {$member.name2|escape}\n        {* Public Profile *}\n        {$member.publish_profile|escape}\n    {/foreach}\n{/if}\n\n{* Date and Time *}\n{$details.date|strtotime|date_format:"Y/m/d H:i"}\n{$details.date|strtotime|date_format:"d-M-Y H:i"}\n\n{* Theme *}\n{$details.thema|escape}\n\n{* Online Streaming *}\n{if $details.streaming.key > 0}\n    {$details.streaming.label}\n{/if}\n\n{* Content *}\n{$details.contents|strip_tags|escape}\n\n')),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/8d66708012387912699190d42b0b6f88.jpg?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/8d66708012387912699190d42b0b6f88.jpg",alt:"Image from Gyazo"})),(0,n.kt)("h3",{id:"saving-the-search-target-string-template"},"Saving the Search Target String Template"),(0,n.kt)("p",null,'After completing the description, click the "Update" button to save it.\nThe configuration is now complete.'),(0,n.kt)("p",null,"When adding or updating content, the search target string will be automatically saved based on the template."),(0,n.kt)("admonition",{type:"caution"},(0,n.kt)("p",{parentName:"admonition"},"It may take a few minutes for the changes to take effect.")),(0,n.kt)("h2",{id:"confirming-the-operation"},"Confirming the Operation"),(0,n.kt)("p",null,"Add content and check the search results from Swagger UI."),(0,n.kt)("h3",{id:"adding-content"},"Adding Content"),(0,n.kt)("p",null,'Add content according to the content structure created in "Creating Content structures".'),(0,n.kt)("p",null,'Enter the content in the form and click the "Add" button to add the content.\nWhen adding or updating content, the search target string will be automatically saved based on the template.'),(0,n.kt)("admonition",{type:"caution"},(0,n.kt)("p",{parentName:"admonition"},"It may take a few minutes for the changes to take effect.")),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/2fe2d22526d6f2b9dca1dd176f823f0c.jpg?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/2fe2d22526d6f2b9dca1dd176f823f0c.jpg",alt:"Image from Gyazo"})),(0,n.kt)("h3",{id:"checking-the-search-target-string"},"Checking the Search Target String"),(0,n.kt)("p",null,'In the editing screen of the added content, click the "Other" button to display the options.\nClick "Keyword Template" to check the output search target string.'),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/0d7499601480a3d489f18af7d23a89c0.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/0d7499601480a3d489f18af7d23a89c0.png",alt:"Image from Gyazo"})),(0,n.kt)("admonition",{type:"caution"},(0,n.kt)("p",{parentName:"admonition"},'The "Keyword Template" option will not be displayed until the changes are reflected.')),(0,n.kt)("p",null,"In this example, the displayed string will be as follows.",(0,n.kt)("br",{parentName:"p"}),"\n",(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/efcb6dd750cc052c9261967b3ffee876.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/efcb6dd750cc052c9261967b3ffee876.png",alt:"Image from Gyazo"})),(0,n.kt)("admonition",{type:"info"},(0,n.kt)("p",{parentName:"admonition"},"If the search target string contains HTML tags, the HTML tags themselves will also be included in the search target.\nIf you want to search without HTML tags, consider using the strip_tags modifier.")),(0,n.kt)("h3",{id:"prepare-the-full-text-search-endpoint"},"Prepare the Full-Text Search Endpoint"),(0,n.kt)("p",null,"Prepare an endpoint for searching."),(0,n.kt)("p",null,"Refer to ",(0,n.kt)("a",{parentName:"p",href:"/docs/tutorials/configure-endpoint/"},"Configuring endpoints")," to create a content structure to be used for full-text search."),(0,n.kt)("p",null,"This time, set the path and model as follows:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Path: search"),(0,n.kt)("li",{parentName:"ul"},"Category: Content"),(0,n.kt)("li",{parentName:"ul"},"Model: Topics, v1"),(0,n.kt)("li",{parentName:"ul"},"Operation: list"),(0,n.kt)("li",{parentName:"ul"},"topics_group_id: 83 (the ID assigned in ",(0,n.kt)("a",{parentName:"li",href:"#create-a-content-structure"},"Create a content structure"),")")),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/3474ebb396afc7df7b1659ec88fbc3cf.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/3474ebb396afc7df7b1659ec88fbc3cf.png",alt:"Image from Gyazo"})),(0,n.kt)("h3",{id:"check-with-swagger-ui"},"Check with Swagger UI"),(0,n.kt)("p",null,"Send a request to the endpoint added in ","[Prepare the Full-Text Search Endpoint]"," from the Swagger UI screen.\nBy entering a keyword in full_text_search, only the contents that include the keyword in the full-text search string will be returned."),(0,n.kt)("p",null,(0,n.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/889c3c08c98f6fd5d9c66108e89e5e33.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/889c3c08c98f6fd5d9c66108e89e5e33.png",alt:"Image from Gyazo"})),(0,n.kt)("h2",{id:"related-documents"},"Related Documents"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/docs/tutorials/adding-a-topics/"},"Creating Content structure")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/docs/management/extra-information/"},"Extended item settings")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/docs/reference/list-of-extra-column-available-on-member-field-settings/"},"List of extension items in member detailed settings.")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/docs/tutorials/configure-endpoint/"},"Configuring endpoints"))))}p.isMDXComponent=!0}}]);