"use strict";(self.webpackChunkkurokuro=self.webpackChunkkurokuro||[]).push([[77191],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>g});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),d=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),m=d(n),u=o,g=m["".concat(s,".").concat(u)]||m[u]||c[u]||r;return n?a.createElement(g,i(i({ref:t},p),{},{components:n})):a.createElement(g,i({ref:t},p))}));function g(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[m]="string"==typeof e?e:o,i[1]=l;for(var d=2;d<r;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},22500:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>d});var a=n(87462),o=(n(67294),n(3905));const r={title:"Using the KurocoFront app domain for your front-end staging site",description:"Once you have your custom domain, you can use the default domain `https://SITE-KEY.g.kuroco-front.app` for your staging site. This tutorial explains how to do so by creating a separate GitHub branch."},i=void 0,l={unversionedId:"tutorials/kurocofront-app-domain-for-front-end-staging-site",id:"tutorials/kurocofront-app-domain-for-front-end-staging-site",title:"Using the KurocoFront app domain for your front-end staging site",description:"Once you have your custom domain, you can use the default domain `https://SITE-KEY.g.kuroco-front.app` for your staging site. This tutorial explains how to do so by creating a separate GitHub branch.",source:"@site/docs/tutorials/kurocofront-app-domain-for-front-end-staging-site.md",sourceDirName:"tutorials",slug:"/tutorials/kurocofront-app-domain-for-front-end-staging-site",permalink:"/docs/tutorials/kurocofront-app-domain-for-front-end-staging-site",draft:!1,editUrl:"https://github.com/diverta/kuroco-documents/tree/main/packages/create-docusaurus/templates/shared/docs/tutorials/kurocofront-app-domain-for-front-end-staging-site.md",tags:[],version:"current",frontMatter:{title:"Using the KurocoFront app domain for your front-end staging site",description:"Once you have your custom domain, you can use the default domain `https://SITE-KEY.g.kuroco-front.app` for your staging site. This tutorial explains how to do so by creating a separate GitHub branch."},sidebar:"documentationSidebar",previous:{title:"Transferring your domain from another site to Kuroco",permalink:"/docs/tutorials/transferring-your-domain-from-another-site-to-kuroco"},next:{title:'Handling a "generate" error in GitHub Actions',permalink:"/docs/tutorials/handling-a-generate-error-in-github-actions"}},s={},d=[{value:"Overview",id:"overview",level:2},{value:"What you&#39;ll learn",id:"what-youll-learn",level:3},{value:"Before you start",id:"before-you-start",level:3},{value:"Implementing a staging site",id:"implementing-a-staging-site",level:2},{value:"1. Create a branch for the staging site on GitHub",id:"1-create-a-branch-for-the-staging-site-on-github",level:3},{value:"2. Create kuroco_front.json for stage site",id:"2-create-kuroco_frontjson-for-stage-site",level:3},{value:"3. Add a YAML file for the stage site",id:"3-add-a-yaml-file-for-the-stage-site",level:3},{value:"4. Push in the stg branch",id:"4-push-in-the-stg-branch",level:3},{value:"5. Merging changes in the stg branch into the main branch",id:"5-merging-changes-in-the-stg-branch-into-the-main-branch",level:3},{value:"Setting up Development Environment",id:"setting-up-development-environment",level:2},{value:"1. Create dev branch",id:"1-create-dev-branch",level:3},{value:"2. Create kuroco_front_dev.json",id:"2-create-kuroco_front_devjson",level:3},{value:"3. Adding a Subsite",id:"3-adding-a-subsite",level:3},{value:"Creating a Subsite",id:"creating-a-subsite",level:4},{value:"GitHub Integration",id:"github-integration",level:4},{value:"4. Setting Up a Custom Domain and Custom API Domain",id:"4-setting-up-a-custom-domain-and-custom-api-domain",level:3},{value:"5. Set up GitHub Secrets for the Development Environment",id:"5-set-up-github-secrets-for-the-development-environment",level:3},{value:"6. Add develop.yml File",id:"6-add-developyml-file",level:3},{value:"7. Push changes to dev branch",id:"7-push-changes-to-dev-branch",level:3},{value:"8. Merge changes from dev branch to main and stg branches",id:"8-merge-changes-from-dev-branch-to-main-and-stg-branches",level:3},{value:"Synchronize data between development and production environments",id:"synchronize-data-between-development-and-production-environments",level:3},{value:"Checking the File Structure",id:"checking-the-file-structure",level:2},{value:"Environment Variable Configuration",id:"environment-variable-configuration",level:2},{value:"Creating Environment Variable Configuration Files",id:"creating-environment-variable-configuration-files",level:3},{value:"Updating the YAML File",id:"updating-the-yaml-file",level:3},{value:"Updating nuxt.config.js",id:"updating-nuxtconfigjs",level:3},{value:"Verifying Environment Variable Integration",id:"verifying-environment-variable-integration",level:3},{value:"Related Documents",id:"related-documents",level:2}],p={toc:d},m="wrapper";function c(e){let{components:t,...n}=e;return(0,o.kt)(m,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"overview"},"Overview"),(0,o.kt)("p",null,"Once you have your custom domain, you can use the default domain ",(0,o.kt)("inlineCode",{parentName:"p"},"https://SITE-KEY.g.kuroco-front.app")," for your staging site. This tutorial explains how to do so by creating a separate GitHub branch.    "),(0,o.kt)("h3",{id:"what-youll-learn"},"What you'll learn"),(0,o.kt)("p",null,"To make ",(0,o.kt)("inlineCode",{parentName:"p"},"https://SITE-KEY.g.kuroco-front.app")," a stage site, perform the following steps."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#implementing-a-staging-site"},"Implementing a staging site")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#setting-up-development-environment"},"Setting up Development Environment")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#confirm-file-configuration"},"Confirm file configuration"))),(0,o.kt)("h3",{id:"before-you-start"},"Before you start"),(0,o.kt)("p",null,"We will implement the following branch and domain structure.  "),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:"left"},"Environment"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Branch"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Domain"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Purpose"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Production"),(0,o.kt)("td",{parentName:"tr",align:"left"},"main"),(0,o.kt)("td",{parentName:"tr",align:"left"},(0,o.kt)("inlineCode",{parentName:"td"},"Custom Domain")),(0,o.kt)("td",{parentName:"tr",align:"left"},"Public-facing site")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Staging"),(0,o.kt)("td",{parentName:"tr",align:"left"},"stg"),(0,o.kt)("td",{parentName:"tr",align:"left"},(0,o.kt)("inlineCode",{parentName:"td"},"https://SITE-KEY.g.kuroco-front.app")),(0,o.kt)("td",{parentName:"tr",align:"left"},"Site for pre-checks of design modifications, separate from backend")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Development"),(0,o.kt)("td",{parentName:"tr",align:"left"},"dev"),(0,o.kt)("td",{parentName:"tr",align:"left"},(0,o.kt)("inlineCode",{parentName:"td"},"Custom Domain")),(0,o.kt)("td",{parentName:"tr",align:"left"},"Site for pre-checks of added functionality, separate from backend and frontend")))),(0,o.kt)("p",null,"Note: While this tutorial uses the branch names stg and dev, you may change them as desired."),(0,o.kt)("p",null,"Furthermore, this tutorial assumes that the procedures for ",(0,o.kt)("a",{parentName:"p",href:"/docs/tutorials/using-a-custom-domain-name-on-kurocofront/"},"Using your own custom domain name on KurocoFront")," and ",(0,o.kt)("a",{parentName:"p",href:"/docs/tutorials/using-your-own-api-domain-with-kurocofront/"},"Using your own API domain with KurocoFront")," have been completed and that your site can be displayed with a custom domain."),(0,o.kt)("h2",{id:"implementing-a-staging-site"},"Implementing a staging site"),(0,o.kt)("h3",{id:"1-create-a-branch-for-the-staging-site-on-github"},"1. Create a branch for the staging site on GitHub"),(0,o.kt)("p",null,"First, separate the production site and staging site displays in the GitHub branch. Go to your directory and execute the following command:  "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"git checkout -b stg\n")),(0,o.kt)("h3",{id:"2-create-kuroco_frontjson-for-stage-site"},"2. Create kuroco_front.json for stage site"),(0,o.kt)("p",null,"Create ",(0,o.kt)("inlineCode",{parentName:"p"},"kuroco_front.json")," for the stage site in order to apply BASIC authentication to the stage site only.  "),(0,o.kt)("p",null,"Copy ",(0,o.kt)("inlineCode",{parentName:"p"},"kuroco_front.json")," under ",(0,o.kt)("inlineCode",{parentName:"p"},"/static")," directory and create ",(0,o.kt)("inlineCode",{parentName:"p"},"kuroco_front_stg.json"),"."),(0,o.kt)("p",null,"Describe Basic authentication as follows."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json",metastring:"[kuroco_front_stg.json]","[kuroco_front_stg.json]":!0},'{\n    "rewrites": [\n        {\n          "source": ".*",\n          "destination": "/index.html"\n        }\n      ],\n    "redirects": [],\n    "basic":["user:pass"],\n    "ip_restrictions":[]\n}\n')),(0,o.kt)("h3",{id:"3-add-a-yaml-file-for-the-stage-site"},"3. Add a YAML file for the stage site"),(0,o.kt)("p",null,"Next, add a YAML file to make the Github Actions work when you push changes in the stg branch.\nClick ","[KurocoFront]"," -> ","[GitHub]"," and copy the content in the ",(0,o.kt)("inlineCode",{parentName:"p"},"GitHub Actions workflow file staging site")," text area.  "),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/acea1283c88c0041c1d6fa15738b04b8.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/acea1283c88c0041c1d6fa15738b04b8.png",alt:"Image from Gyazo"})),(0,o.kt)("p",null,"Create a ",(0,o.kt)("inlineCode",{parentName:"p"},".github/workflows/staging.yml")," file with the copied contents"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/364e0a52220634890b9a078f27c38d13.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/364e0a52220634890b9a078f27c38d13.png",alt:"Image from Gyazo"})),(0,o.kt)("p",null,"In addition, make the following modifications to the ",(0,o.kt)("inlineCode",{parentName:"p"},"staging.yml")," file."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Rename the Github Actions",(0,o.kt)("br",{parentName:"p"}),"\n","Change the first line to the following.",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("inlineCode",{parentName:"p"},"name: Build and deploy to Kuroco front(stg)"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Change the branch that triggers the Github Actions execution",(0,o.kt)("br",{parentName:"p"}),"\n","replace the text following ",(0,o.kt)("inlineCode",{parentName:"p"},"branches:")," in the build.yml file with the branch name of your staging site. For this tutorial, we are changing this text from ",(0,o.kt)("inlineCode",{parentName:"p"},"main")," to ",(0,o.kt)("inlineCode",{parentName:"p"},"stg"),".")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Load the GitHub secret.",(0,o.kt)("br",{parentName:"p"}),"\n","Add the following statement just before jobs: in .github/workflows/staging.yml"),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre"},"env:\nBASE_URL: ${{secrets.BASE_URL}}\n"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Using kuroco_front.json for stage sites",(0,o.kt)("br",{parentName:"p"}),"\n","The JSON file for using KurocoFront is ",(0,o.kt)("inlineCode",{parentName:"p"},"kuroco_front.json"),".",(0,o.kt)("br",{parentName:"p"}),"\n","Therefore, we will add code to the YAML file to copy ",(0,o.kt)("inlineCode",{parentName:"p"},"kuroco_front_stg.json")," to ",(0,o.kt)("inlineCode",{parentName:"p"},"kuroco_front.json"),", so that ",(0,o.kt)("inlineCode",{parentName:"p"},"kuroco_front_stg.json")," will be used only when ",(0,o.kt)("inlineCode",{parentName:"p"},"staging.yml")," is executed.",(0,o.kt)("br",{parentName:"p"}),"\n","Add the following description just before ",(0,o.kt)("inlineCode",{parentName:"p"},"- name: Use Node.js")," in ",(0,o.kt)("inlineCode",{parentName:"p"},".github/workflows/staging.yml"),". (2 places)   "),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre"},"- name: Copy kuroco_front.json\n  run: cp static/kuroco_front_stg.json static/kuroco_front.json \n")))),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"staging.yml")," file should look like this."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/773c1d9fafdad6c8f5e6c684c3819393.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/773c1d9fafdad6c8f5e6c684c3819393.png",alt:"Image from Gyazo"})),(0,o.kt)("p",null,"Save the file after the modification.  "),(0,o.kt)("h3",{id:"4-push-in-the-stg-branch"},"4. Push in the stg branch"),(0,o.kt)("p",null,"Push the changes to GithHub.\nClick on the ","[Actions]"," tab on GitHub to check the build status and see that the build is running with the contents of ",(0,o.kt)("inlineCode",{parentName:"p"},"staging.yml"),"."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/aa3454a60eebf160b6d4c8612eb3e640.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/aa3454a60eebf160b6d4c8612eb3e640.png",alt:"Image from Gyazo"})),(0,o.kt)("p",null,"Once the build is completed, access the staging site from the logo on the Kuroco admin panel.  "),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/e940a07a3a2f16c9492e5e7a64f56eae.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/e940a07a3a2f16c9492e5e7a64f56eae.png",alt:"Image from Gyazo"})),(0,o.kt)("p",null,"You will see that the staging site now requires basic authentication.  "),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/53cdde2e00b8e2f19dded4f6ae06ee46.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/53cdde2e00b8e2f19dded4f6ae06ee46.png",alt:"Image from Gyazo"})),(0,o.kt)("p",null,"Click ","[Top page]"," in Kuroco to open the production site, which does not require basic authentication. As expected, the production site will not reflect any updates to the ",(0,o.kt)("inlineCode",{parentName:"p"},"stg")," branch.  "),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/9cf807b1348222fb3b25d3789740dd92.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/9cf807b1348222fb3b25d3789740dd92.png",alt:"Image from Gyazo"})),(0,o.kt)("h3",{id:"5-merging-changes-in-the-stg-branch-into-the-main-branch"},"5. Merging changes in the stg branch into the main branch"),(0,o.kt)("p",null,"Finally, merge the above into the main branch.\nThe production build.yml file will be executed, but the modified file will be the following, so it will not affect the front-end display."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"staging.yml"),(0,o.kt)("li",{parentName:"ul"},"kuroco_front_stg.json")),(0,o.kt)("p",null,"This completes the stage site setup.",(0,o.kt)("br",{parentName:"p"}),"\n","The staging domain (",(0,o.kt)("inlineCode",{parentName:"p"},"https://SITE-KEY.g.kuroco-front.app"),") will now reflect any changes to the staging site in the ",(0,o.kt)("inlineCode",{parentName:"p"},"stg")," branch."),(0,o.kt)("h2",{id:"setting-up-development-environment"},"Setting up Development Environment"),(0,o.kt)("h3",{id:"1-create-dev-branch"},"1. Create dev branch"),(0,o.kt)("p",null,"Separate the production and development environments on GitHub branches.\nAfter moving to the target directory, execute the following command from the command line."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"git checkout -b dev\n")),(0,o.kt)("h3",{id:"2-create-kuroco_front_devjson"},"2. Create kuroco_front_dev.json"),(0,o.kt)("p",null,"To apply BASIC authentication only to the development environment, create kuroco_front_dev.json for the development environment."),(0,o.kt)("p",null,"Copy /static/kuroco_front.json and create kuroco_front_dev.json."),(0,o.kt)("p",null,"Describe Basic authentication as follows."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json",metastring:"[kuroco_front_dev.json]","[kuroco_front_dev.json]":!0},'{\n    "rewrites": [\n        {\n          "source": ".*",\n          "destination": "/index.html"\n        }\n      ],\n    "redirects": [],\n    "basic":["user:pass"],\n    "ip_restrictions":[]\n}\n')),(0,o.kt)("h3",{id:"3-adding-a-subsite"},"3. Adding a Subsite"),(0,o.kt)("p",null,"Next, to separate the backend from the development environment, we will create a subsite from the Kuroco management screen."),(0,o.kt)("h4",{id:"creating-a-subsite"},"Creating a Subsite"),(0,o.kt)("p",null,"Click on ","[Environment Settings]"," -> ","[Site List]","."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/29ae87d6b092c6f831d2fc5e42f08f7f.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/29ae87d6b092c6f831d2fc5e42f08f7f.png",alt:"Image from Gyazo"})),(0,o.kt)("p",null,"Click on ","[Add]","."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/a6bfa45c9c86052aedcfde3e7f0b668d.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/a6bfa45c9c86052aedcfde3e7f0b668d.png",alt:"Image from Gyazo"})),(0,o.kt)("p",null,"Please click ","[Add]"," after setting as follows:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:"left"},"Item"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Setting"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Source site name"),(0,o.kt)("td",{parentName:"tr",align:"left"},"Select the production environment site")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Site name"),(0,o.kt)("td",{parentName:"tr",align:"left"},"Development site")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Site key"),(0,o.kt)("td",{parentName:"tr",align:"left"},"Any site key")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Email address"),(0,o.kt)("td",{parentName:"tr",align:"left"},"Destination for completion email of site construction")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Initial password"),(0,o.kt)("td",{parentName:"tr",align:"left"},"Any password")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Company name"),(0,o.kt)("td",{parentName:"tr",align:"left"},"Your company name")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Name"),(0,o.kt)("td",{parentName:"tr",align:"left"},"Your name")))),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/8bc7f712a0808f78fe0b7cd757b06318.jpg?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/8bc7f712a0808f78fe0b7cd757b06318.jpg",alt:"Image from Gyazo"})),(0,o.kt)("h4",{id:"github-integration"},"GitHub Integration"),(0,o.kt)("p",null,"After creating the subsite, connect it to GitHub. Click ","[KurocoFront]"," -> ","[GitHub]","."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/be03db0db0f19ab5f2ef9b209426c6e1.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/be03db0db0f19ab5f2ef9b209426c6e1.png",alt:"Image from Gyazo"})),(0,o.kt)("p",null,"Click ","[Authorize GitHub Repository]"," and integrate with GitHub.  "),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/395a29364b2db08ec8f2d25b4057ae8d.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/395a29364b2db08ec8f2d25b4057ae8d.png",alt:"Image from Gyazo"})),(0,o.kt)("p",null,"After connecting with GitHub, set the repository to the same as the production environment repository and click ","[Update]","."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/7fd3b2c26547b8962ff865c8708eea32.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/7fd3b2c26547b8962ff865c8708eea32.png",alt:"Image from Gyazo"})),(0,o.kt)("h3",{id:"4-setting-up-a-custom-domain-and-custom-api-domain"},"4. Setting Up a Custom Domain and Custom API Domain"),(0,o.kt)("p",null,"Set up a custom domain and custom API domain for the development environment. Set up the custom domain and custom API domain for the development environment from ","[Environment Settings]"," -> ","[Custom Domain/TLS Certificates]","."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/16d285e812debed3646c9757549feff7.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/16d285e812debed3646c9757549feff7.png",alt:"Image from Gyazo"})),(0,o.kt)("p",null,"Once the DNS settings are reflected and everything shows OK, the setup is complete."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/d45aaf635d1b5717f45dd0ebf690785c.jpg?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/d45aaf635d1b5717f45dd0ebf690785c.jpg",alt:"Image from Gyazo"})),(0,o.kt)("p",null,"Go to Environment Settings -> Account Settings and change the Front-end domain and API Domain."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/6638ebf2fcdc4f0c80a96af34da67095.jpg?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/6638ebf2fcdc4f0c80a96af34da67095.jpg",alt:"Image from Gyazo"})),(0,o.kt)("h3",{id:"5-set-up-github-secrets-for-the-development-environment"},"5. Set up GitHub Secrets for the Development Environment"),(0,o.kt)("p",null,"As the backend differs from the production environment, the API Domain will be different from the production environment in the development environment. In the Kuroco Beginner's Guide, the API Domain is set as a GitHub Secret. Therefore, add a GitHub Secret that sets the API Domain for the development environment."),(0,o.kt)("p",null,"Go to the repository page on GitHub, click on Settings -> Secrets -> Actions, and click on New repository secret."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/a983ec5941628589a37df3db6e9bd947.jpg?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/a983ec5941628589a37df3db6e9bd947.jpg",alt:"Image from Gyazo"})),(0,o.kt)("p",null,"Enter the following and click on Add secret."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:"left"},"Item"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Name"),(0,o.kt)("td",{parentName:"tr",align:"left"},"BASE_URL_DEV")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},"Secret"),(0,o.kt)("td",{parentName:"tr",align:"left"},"API Domain for the development environment")))),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/f8b7e085058ba58fba37a73029912454.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/f8b7e085058ba58fba37a73029912454.png",alt:"Image from Gyazo"})),(0,o.kt)("h3",{id:"6-add-developyml-file"},"6. Add develop.yml File"),(0,o.kt)("p",null,"Next, add a YAML file for GitHub Actions to run when changes are pushed to the dev branch. From the Kuroco management screen for the development environment created earlier, click on ","[KurocoFront]"," -> ","[GitHub]",'. Copy the contents of the "GitHub Actions workflow file Front-end Domain" text area.'),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/3d902ad94a67e7a6e71c7727abf73ac6.jpg?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/3d902ad94a67e7a6e71c7727abf73ac6.jpg",alt:"Image from Gyazo"})),(0,o.kt)("p",null,"Create a ",(0,o.kt)("inlineCode",{parentName:"p"},".github/workflows/develop.yml")," file with the copied content."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/b6bd2ccd6cdb0803e8f32e320f5effbb.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/b6bd2ccd6cdb0803e8f32e320f5effbb.png",alt:"Image from Gyazo"})),(0,o.kt)("p",null,"Then make the following modifications to the ",(0,o.kt)("inlineCode",{parentName:"p"},"develop.yml")," file:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Change the name of the Github Actions\nChange the following line in the first line:\n",(0,o.kt)("inlineCode",{parentName:"p"},"name: Build and deploy to Kuroco front(dev)"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Change the branch that triggers Github Actions execution\nModify ",(0,o.kt)("inlineCode",{parentName:"p"},"branches:")," to the branch name for the development environment.\nIn this case, modify it to ",(0,o.kt)("inlineCode",{parentName:"p"},"dev"),". ")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Load GitHub secrets\nAdd the following description before the ",(0,o.kt)("inlineCode",{parentName:"p"},"jobs:")," section in ",(0,o.kt)("inlineCode",{parentName:"p"},".github/workflows/develop.yml"),":  "),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre"},"env:\nBASE_URL: ${{secrets.BASE_URL_DEV}}\n"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Use ",(0,o.kt)("inlineCode",{parentName:"p"},"kuroco_front_dev.json")," for the development environment\nThe JSON file used to use KurocoFront is ",(0,o.kt)("inlineCode",{parentName:"p"},"kuroco_front.json"),".",(0,o.kt)("br",{parentName:"p"}),"\n","Therefore, add a YAML file description to copy ",(0,o.kt)("inlineCode",{parentName:"p"},"kuroco_front_dev.json")," to ",(0,o.kt)("inlineCode",{parentName:"p"},"kuroco_front.json")," only when ",(0,o.kt)("inlineCode",{parentName:"p"},"develop.yml")," is executed.",(0,o.kt)("br",{parentName:"p"}),"\n","Add the following description before ",(0,o.kt)("inlineCode",{parentName:"p"},"- name: Use Node.js")," in ",(0,o.kt)("inlineCode",{parentName:"p"},".github/workflows/develop.yml")," (in two places):  "),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre"},"- name: Copy kuroco_front.json\n  run:  cp static/kuroco_front_dev.json static/kuroco_front.json \n")))),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"develop.yml")," file will be as follows:"),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/ddf431f9ac0700a93ab767cdd7edd5fa.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/ddf431f9ac0700a93ab767cdd7edd5fa.png",alt:"Image from Gyazo"})),(0,o.kt)("p",null,"Save the file when the modifications are complete."),(0,o.kt)("h3",{id:"7-push-changes-to-dev-branch"},"7. Push changes to dev branch"),(0,o.kt)("p",null,'Push the changes made so far to GitHub. When you click on the "Actions" tab in GitHub, you can check the status of the build and see that the build is being executed with the contents of develop.yml.'),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/333e5c73b4458dc350895597292583a7.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/333e5c73b4458dc350895597292583a7.png",alt:"Image from Gyazo"})),(0,o.kt)("p",null,"Once the build is complete, access the development environment site from the ","[View site]"," button on the Kuroco management screen."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/038f3becdc4550bf0a7eae5cff529201.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/038f3becdc4550bf0a7eae5cff529201.png",alt:"Image from Gyazo"})),(0,o.kt)("p",null,"Other than the BASIC authentication, the display will be the same as the production environment."),(0,o.kt)("h3",{id:"8-merge-changes-from-dev-branch-to-main-and-stg-branches"},"8. Merge changes from dev branch to main and stg branches"),(0,o.kt)("p",null,"Merge the above contents into the main and stg branches. The build.yml file and staging.yml file will be executed, but the following files have been changed, so there will be no impact on the front-end display."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"develop.yml"),(0,o.kt)("li",{parentName:"ul"},"kuroco_front_dev.json")),(0,o.kt)("p",null,"With this, the development environment setup is complete. From now on, the changes made in the development environment branch (in this case, dev) and the management screen of the development environment site will be reflected in the development environment site."),(0,o.kt)("h3",{id:"synchronize-data-between-development-and-production-environments"},"Synchronize data between development and production environments"),(0,o.kt)("p",null,"If there is a significant difference in data between the production and development environments, or if you want to reflect updates and additions made in the development environment to the production environment all at once, you can use the synchronization function."),(0,o.kt)("p",null,"Click ","[Edit]"," of the site that will be the synchronization destination from the Site List."),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/a35194c33476640472b2d55b4403c4a5.jpg?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/a35194c33476640472b2d55b4403c4a5.jpg",alt:"Image from Gyazo"})),(0,o.kt)("p",null,'Select the Sync source site key in the Synchronization item, check the "Sync immediately" checkbox, and update.'),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/1faace6729178286f95930c635ba4cdf.jpg?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/1faace6729178286f95930c635ba4cdf.jpg",alt:"Image from Gyazo"})),(0,o.kt)("p",null,'When "Updated." is displayed, synchronization is complete.'),(0,o.kt)("admonition",{type:"danger"},(0,o.kt)("p",{parentName:"admonition"},"If you synchronize in the wrong direction, all necessary data will be overwritten. Therefore, we recommend that you back up your data as needed.")),(0,o.kt)("h2",{id:"checking-the-file-structure"},"Checking the File Structure"),(0,o.kt)("p",null,"Once the preparation for using the development environment is complete, the following files should exist in any branch. If it's not working properly, please check if the file structure is correct."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},".github\\workflows\n  - build.yml\n  - develop.yml\n  - staging.yml\nstatic\n  - kuroco_front_dev.json\n  - kuroco_front_stg.json\n  - kuroco_front.json\n")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://t.gyazo.com/teams/diverta/9d95af237662dc507c047e0f6493af12.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/9d95af237662dc507c047e0f6493af12.png",alt:"Image from Gyazo"})),(0,o.kt)("h2",{id:"environment-variable-configuration"},"Environment Variable Configuration"),(0,o.kt)("p",null,"It is common to use different environment variables for development and production environments. In this tutorial, we explained how to store the API domain in GitHub secrets and switch between them. However, if you have a large number of environment variables, using environment variable configuration files can reduce the effort required for verification and updates."),(0,o.kt)("p",null,"However, since you can check the variables from the GitHub repository, you should choose whether to use GitHub secrets or environment variable configuration files based on the required level of confidentiality."),(0,o.kt)("h3",{id:"creating-environment-variable-configuration-files"},"Creating Environment Variable Configuration Files"),(0,o.kt)("p",null,"Create the following environment variable configuration files and apply them to each environment."),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:"left"},"File Name"),(0,o.kt)("th",{parentName:"tr",align:"left"},"Purpose"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},".env.production.js"),(0,o.kt)("td",{parentName:"tr",align:"left"},"Environment variable configuration for production environment")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},".env.staging.js"),(0,o.kt)("td",{parentName:"tr",align:"left"},"Environment variable configuration for staging environment")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:"left"},".env.develop.js"),(0,o.kt)("td",{parentName:"tr",align:"left"},"Environment variable configuration for development environment")))),(0,o.kt)("p",null,"First, create each file with the following content:"),(0,o.kt)("p",null,".env.production.js"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = {\n  SITE_TITLE: 'Kuroco Sample Site',\n  META_TITLE: 'Kuroco Sample Site',\n  SITE_DESCRIPTION: 'A sample site created with reference to the Kuroco Beginner\\'s Guide.',\n  RSS_SITE_TITLE: 'Kuroco Sample',\n  RSS_SITE_DESCRIPTION: 'Start using Kuroco with the Kuroco Beginner\\'s Guide',\n  ROBOTS: 'index',\n}\n")),(0,o.kt)("p",null,".env.staging.js"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = {\n  SITE_TITLE: '[STG]|Kuroco Sample Site',\n  META_TITLE: '[STG]|Kuroco Sample Site',\n  SITE_DESCRIPTION: '[STG]|A sample site created with reference to the Kuroco Beginner\\'s Guide.',\n  RSS_SITE_TITLE: '[STG]|Kuroco Sample',\n  RSS_SITE_DESCRIPTION: '[STG]|Start using Kuroco with the Kuroco Beginner\\'s Guide',\n  ROBOTS: 'noindex',\n}\n")),(0,o.kt)("p",null,".env.development.js"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = {\n  SITE_TITLE: '[DEV]|Kuroco Sample Site',\n  META_TITLE: '[DEV]|Kuroco Sample Site',\n  SITE_DESCRIPTION: '[DEV]|A sample site created with reference to the Kuroco Beginner\\'s Guide.',\n  RSS_SITE_TITLE: '[DEV]|Kuroco Sample',\n  RSS_SITE_DESCRIPTION: '[DEV]|Start using Kuroco with the Kuroco Beginner\\'s Guide',\n  ROBOTS: 'noindex',\n}\n")),(0,o.kt)("h3",{id:"updating-the-yaml-file"},"Updating the YAML File"),(0,o.kt)("p",null,"Define NODE_ENV using the env section of the YAML file."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"env:\n  BASE_URL: ${{secrets.BASE_URL}}\n")),(0,o.kt)("p",null,"Add the following lines below this section:  "),(0,o.kt)("p",null,"build.yml"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"env:\n  BASE_URL: ${{secrets.BASE_URL}}\n  NODE_ENV: production\n")),(0,o.kt)("p",null,"staging.yml"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"env:\n  BASE_URL: ${{secrets.BASE_URL}}\n  NODE_ENV: staging\n")),(0,o.kt)("p",null,"develop.yml"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"  BASE_URL: ${{secrets.BASE_URL_DEV}}\n  NODE_ENV: development\n")),(0,o.kt)("h3",{id:"updating-nuxtconfigjs"},"Updating nuxt.config.js"),(0,o.kt)("p",null,"Since the NODE_ENV will contain the string specified in the YAML file, we can use this to load the environment-specific configuration files in nuxt.config.js."),(0,o.kt)("p",null,"Update nuxt.config.js as follows. Feel free to include other necessary configurations besides the site title in the header."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const environment = process.env.NODE_ENV || 'development';\nconst envSettings  = require(`./.env.${environment}.js`);\n\nexport default {\n  env: envSettings,\n\n  // Disable server-side rendering: https://go.nuxtjs.dev/ssr-mode\n  ssr: false,\n  // Target: https://go.nuxtjs.dev/config-target\n  target: 'static',\n\n  // Global page headers: https://go.nuxtjs.dev/config-head\n  head: {\n    title: envSettings.SITE_TITLE,\n    htmlAttrs: {\n      lang: 'en'\n    },\n    meta: [\n      { charset: 'utf-8' },\n  \u30fb\n  \u30fb\n  \u30fb\n")),(0,o.kt)("h3",{id:"verifying-environment-variable-integration"},"Verifying Environment Variable Integration"),(0,o.kt)("p",null,"Apply the changes to each environment, and after the build is completed, verify the display for each environment."),(0,o.kt)("p",null,"If the site title specific to each environment is displayed as shown below, the process is complete."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Production\n",(0,o.kt)("img",{parentName:"li",src:"https://t.gyazo.com/teams/diverta/80cb2a66a6fae4ba3d09f570ae85cadd.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/80cb2a66a6fae4ba3d09f570ae85cadd.png",alt:"Image from Gyazo"})),(0,o.kt)("li",{parentName:"ul"},"Staging\n",(0,o.kt)("img",{parentName:"li",src:"https://t.gyazo.com/teams/diverta/74bb4e69848521ab9fd9e1e576fe26db.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/74bb4e69848521ab9fd9e1e576fe26db.png",alt:"Image from Gyazo"})),(0,o.kt)("li",{parentName:"ul"},"Development\n",(0,o.kt)("img",{parentName:"li",src:"https://t.gyazo.com/teams/diverta/2f0e84c56178147269ce282d883c71bb.png?width=600","data-zoom-src":"https://t.gyazo.com/teams/diverta/2f0e84c56178147269ce282d883c71bb.png",alt:"Image from Gyazo"}))),(0,o.kt)("h2",{id:"related-documents"},"Related Documents"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/tutorials/beginners-guide/"},"Beginner's guide to Kuroco")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/tutorials/using-a-custom-domain-name-on-kurocofront/"},"Using your own custom domain name on KurocoFront")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/tutorials/using-your-own-api-domain-with-kurocofront/"},"Using your own API domain with KurocoFront"))))}c.isMDXComponent=!0}}]);